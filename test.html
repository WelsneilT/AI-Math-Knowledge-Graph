<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒê·ªì th·ªã Ki·∫øn th·ª©c To√°n THPT 3D - N√¢ng cao</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0a0e27;
      color: #fff;
      overflow: hidden; 
    }
    
    #graph-container {
      width: 100vw;
      height: 100vh;
    }
    
    .panel {
      position: absolute;
      background-color: rgba(20, 25, 45, 0.95);
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid rgba(100, 150, 255, 0.4);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      z-index: 1000;
    }
    
    .info {
      top: 10px;
      left: 10px;
      max-width: 160px;
    }
    
    .info h3 { 
      margin: 0 0 8px 0;
      font-size: 12px;
      color: #6ca0dc;
      border-bottom: 2px solid rgba(108, 160, 220, 0.3);
      padding-bottom: 4px;
    }
    
    .legend-item { 
      display: flex; 
      align-items: center; 
      margin-bottom: 6px;
      font-size: 10px;
      transition: transform 0.2s;
    }
    
    .legend-item:hover {
      transform: translateX(3px);
    }
    
    .legend-color { 
      width: 25px; 
      height: 3px; 
      margin-right: 8px;
      border-radius: 2px;
      box-shadow: 0 0 8px currentColor;
    }
    
    .legend-note {
      font-size: 9px;
      color: #888;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(100, 150, 255, 0.2);
      font-style: italic;
    }
    
    /* SEARCH BOX - Ph·∫£i tr√™n c√πng */
    .search-box {
      top: 10px;
      right: 10px;
      min-width: 320px;
      max-width: 320px;
      padding: 10px 12px;
    }
    
    .search-box h3 {
      margin: 0 0 8px 0;
      font-size: 12px;
      color: #6ca0dc;
      border-bottom: 2px solid rgba(108, 160, 220, 0.3);
      padding-bottom: 4px;
    }
    
    .search-box input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid rgba(100, 150, 255, 0.4);
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 12px;
    }
    
    .search-box input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }
    
    /* CONTROLS - G√≥c ph·∫£i d∆∞·ªõi, 5 n√∫t 1 h√†ng ngang */
    .controls {
      bottom: 10px;
      right: 10px;
      display: flex;
      gap: 8px;
      padding: 10px;
    }
    
    .controls button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 11px;
      transition: all 0.3s;
      font-weight: 500;
      white-space: nowrap;
    }
    
    .controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .controls button:active {
      transform: translateY(0);
    }
    
    .instructions {
      bottom: 10px;
      left: 10px;
      font-size: 10px;
      color: #aaa;
      max-width: 350px;
      line-height: 1.5;
    }
    
    .instructions strong {
      color: #6ca0dc;
    }
    
    .node-detail {
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      max-width: 320px;
      min-width: 320px;
      max-height: 70vh;
      overflow-y: auto;
      display: none;
    }
    
    .node-detail.active {
      display: block;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-50%) translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateY(-50%) translateX(0);
      }
    }
    
    .node-detail h2 {
      font-size: 15px;
      margin-bottom: 10px;
      color: #ffd700;
      border-bottom: 2px solid rgba(255, 215, 0, 0.3);
      padding-bottom: 5px;
    }
    
    .node-detail h3 {
      font-size: 13px;
      margin: 12px 0 6px 0;
      color: #6ca0dc;
    }
    
    .node-detail ul {
      list-style: none;
      padding-left: 0;
    }
    
    .node-detail li {
      margin: 6px 0;
      padding-left: 15px;
      position: relative;
      font-size: 11px;
      line-height: 1.5;
    }
    
    .node-detail li:before {
      content: "‚ñ∏";
      position: absolute;
      left: 3px;
      color: #6ca0dc;
    }
    
    .close-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 14px;
      line-height: 1;
      transition: all 0.3s;
    }
    
    .close-btn:hover {
      background: rgba(255, 100, 100, 0.8);
      transform: rotate(90deg);
    }
    
    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 10px;
      font-weight: bold;
      margin-right: 3px;
    }
    
    .badge-10 { background: #9999ff; }
    .badge-11 { background: #f5d442; color: #000; }
    .badge-12 { background: #ff8c42; }
    
    ::-webkit-scrollbar {
      width: 5px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(108, 160, 220, 0.5);
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(108, 160, 220, 0.8);
    }

    .stats {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(100, 150, 255, 0.3);
      font-size: 10px;
      color: #aaa;
    }

    .stat-item {
      margin: 3px 0;
    }

    .stat-number {
      color: #6ca0dc;
      font-weight: bold;
      font-size: 11px;
    }
  </style>
</head>
<body>
  <div id="graph-container"></div>

  <div class="panel info">
    <h3>üìö Ch√∫ th√≠ch</h3>
    <div class="legend-item">
      <div class="legend-color" style="background-color: #ff6961;"></div>
      <span>Ki·∫øn th·ª©c ti√™n quy·∫øt</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background-color: #6CA0DC;"></div>
      <span>Ph√¢n r√£ ki·∫øn th·ª©c</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background-color: #77dd77;"></div>
      <span>Ki·∫øn th·ª©c ·ª©ng d·ª•ng</span>
    </div>
    <div class="legend-note">
     <strong>Hover</strong> ƒë·ªÉ xem tr∆∞·ªõc<br>
    <strong>Click</strong> ƒë·ªÉ c·ªë ƒë·ªãnh
    </div>
    <div class="stats">
      <div class="stat-item">Ch∆∞∆°ng: <span class="stat-number" id="total-chapters">0</span></div>
      <div class="stat-item">Li√™n k·∫øt: <span class="stat-number" id="total-links">0</span></div>
    </div>
  </div>

  <div class="panel search-box">
    <h3> T√¨m ki·∫øm</h3>
    <input type="text" id="search-input" placeholder="Nh·∫≠p t√™n ch∆∞∆°ng ƒë·ªÉ t√¨m ki·∫øm..." oninput="searchNode(this.value)">
  </div>

  <div class="panel controls">
    <button onclick="viewAngle()">G√≥c nghi√™ng</button>
    <button onclick="viewTop()">T·ª´ tr√™n xu·ªëng</button>
    <button onclick="viewSide()">G√≥c ngang</button>
    <button onclick="resetView()">ƒê·∫∑t l·∫°i</button>
    <button onclick="togglePhysics()">V·∫≠t l√Ω</button>
</div>

  <div class="panel instructions">
    <strong>K√©o:</strong> Xoay | <strong>Scroll:</strong> Zoom | <strong>Ph·∫£i:</strong> Di chuy·ªÉn<br>
    <strong>Hover node:</strong> Xem tr∆∞·ªõc li√™n k·∫øt | <strong>Click:</strong> Xem chi ti·∫øt & c·ªë ƒë·ªãnh m√†u
  </div>

  <div class="panel node-detail" id="node-detail">
    <button class="close-btn" onclick="closeDetail()">√ó</button>
    <div id="detail-content"></div>
  </div>

  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three-spritetext@1.8.2/dist/three-spritetext.min.js"></script>
  <script src="https://unpkg.com/3d-force-graph@1.73.3/dist/3d-force-graph.min.js"></script>

  <script>

  const createConsolidationPracticeDetailed = (chapterNumber, details) => ({
          name: `B√†i t·∫≠p cu·ªëi ch∆∞∆°ng ${chapterNumber}`,
          type: 'consolidation_practice',
          color: '#ffd700', // M√†u v√†ng ƒë·∫∑c tr∆∞ng cho b√†i t·∫≠p
          val: 5, // K√≠ch th∆∞·ªõc nh·ªè h∆°n node ch∆∞∆°ng
          learning_objectives: details
      });

const fullKnowledgeData = {
  nodes: [
    // L·ªöP 10
    { 
      id: "CH∆Ø∆†NG I. M·ªÜNH ƒê·ªÄ V√Ä T·∫¨P H·ª¢P", 
      group: 10, 
      color: '#9999ff', 
      val: 9, 
      type: 'chapter', 
      description: "N·ªÅn t·∫£ng logic v√† ng√¥n ng·ªØ to√°n h·ªçc", 
      prerequisites: [], 
      applications: ["CH∆Ø∆†NG II. B·∫§T PH∆Ø∆†NG TR√åNH V√Ä H·ªÜ B·∫§T PH∆Ø∆†NG TR√åNH B·∫¨C NH·∫§T HAI ·∫®N", "CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG", "CH∆Ø∆†NG IX. T√çNH X√ÅC SU·∫§T THEO ƒê·ªäNH NGHƒ®A C·ªî ƒêI·ªÇN", "CH∆Ø∆†NG IV. QUAN H·ªÜ SONG SONG TRONG KH√îNG GIAN"],
      lessons: [		
        { name: "M·ªánh ƒë·ªÅ" }, 
        { name: "T·∫≠p h·ª£p v√† c√°c ph√©p to√°n tr√™n t·∫≠p h·ª£p" },
        createConsolidationPracticeDetailed("I", [
            { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh t√≠nh ƒë√∫ng/sai, ph·ªß ƒë·ªãnh, v√† m·ªëi quan h·ªá k√©o theo c·ªßa c√°c m·ªánh ƒë·ªÅ ch·ª©a bi·∫øn." },
            { level: "V·∫≠n d·ª•ng", content: "S·ª≠ d·ª•ng c√°c ph√©p to√°n tr√™n t·∫≠p h·ª£p (h·ª£p, giao, hi·ªáu, ph·∫ßn b√π) ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n v·ªÅ s·ªë, kho·∫£ng, ƒëo·∫°n." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n t·ªïng h·ª£p li√™n quan ƒë·∫øn vi·ªác x√°c ƒë·ªãnh t·∫≠p h·ª£p v√† c√°c ph√©p to√°n tr√™n t·∫≠p h·ª£p c√≥ tham s·ªë." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG II. B·∫§T PH∆Ø∆†NG TR√åNH V√Ä H·ªÜ B·∫§T PH∆Ø∆†NG TR√åNH B·∫¨C NH·∫§T HAI ·∫®N", 
      group: 10, 
      color: '#9999ff', 
      val: 8, 
      type: 'chapter', 
      description: "Gi·∫£i b·∫•t ph∆∞∆°ng tr√¨nh v√† h·ªá b·∫•t ph∆∞∆°ng tr√¨nh trong kh√¥ng gian 2D", 
      prerequisites: ["CH∆Ø∆†NG I. M·ªÜNH ƒê·ªÄ V√Ä T·∫¨P H·ª¢P"], 
      applications: ["CH∆Ø∆†NG I. ·ª®NG D·ª§NG ƒê·∫†O H√ÄM ƒê·ªÇ KH·∫¢O S√ÅT V√Ä V·∫º ƒê·ªí TH·ªä H√ÄM S·ªê"],
      lessons: [
        { name: "B·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c nh·∫•t hai ·∫©n" }, 
        { name: "H·ªá b·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c nh·∫•t hai ·∫©n" },
        createConsolidationPracticeDetailed("II", [
            { level: "Th√¥ng hi·ªÉu", content: "Bi·ªÉu di·ªÖn mi·ªÅn nghi·ªám c·ªßa h·ªá b·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c nh·∫•t hai ·∫©n tr√™n m·∫∑t ph·∫≥ng t·ªça ƒë·ªô." },
            { level: "V·∫≠n d·ª•ng", content: "X√°c ƒë·ªãnh mi·ªÅn nghi·ªám v√† c√°c ƒëi·ªÉm c·ª±c tr·ªã trong mi·ªÅn nghi·ªám c·ªßa h·ªá b·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c nh·∫•t hai ·∫©n." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n t·ªëi ∆∞u h√≥a (t√¨m gi√° tr·ªã l·ªõn nh·∫•t, nh·ªè nh·∫•t) c·ªßa bi·ªÉu th·ª©c b·∫≠c nh·∫•t tr√™n mi·ªÅn nghi·ªám c·ªßa h·ªá b·∫•t ph∆∞∆°ng tr√¨nh th·ª±c t·∫ø." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG III. H·ªÜ TH·ª®C L∆Ø·ª¢NG TRONG TAM GI√ÅC", 
      group: 10, 
      color: '#9999ff', 
      val: 9, 
      type: 'chapter', 
      description: "ƒê·ªãnh l√Ω sin, cosin v√† c√°c h·ªá th·ª©c l∆∞·ª£ng gi√°c c∆° b·∫£n", 
      prerequisites: [], 
      applications: ["CH∆Ø∆†NG I. H√ÄM S·ªê L∆Ø·ª¢NG GI√ÅC V√Ä PH∆Ø∆†NG TR√åNH L∆Ø·ª¢NG GI√ÅC"],
      lessons: [
        { name: "Gi√° tr·ªã l∆∞·ª£ng gi√°c c·ªßa g√≥c 0¬∞-180¬∞" }, 
        { name: "H·ªá th·ª©c l∆∞·ª£ng trong tam gi√°c" },
        createConsolidationPracticeDetailed("III", [
            { level: "Th√¥ng hi·ªÉu", content: "V·∫≠n d·ª•ng c√°c h·ªá th·ª©c l∆∞·ª£ng gi√°c c∆° b·∫£n (sin, cos, tan, cot) v√† c√¥ng th·ª©c di·ªán t√≠ch ƒë·ªÉ gi·∫£i c√°c b√†i to√°n trung b√¨nh trong tam gi√°c." },
            { level: "V·∫≠n d·ª•ng", content: "√Åp d·ª•ng ƒë·ªãnh l√Ω sin, cosin ƒë·ªÉ gi·∫£i tam gi√°c (t√¨m c√°c y·∫øu t·ªë c√≤n l·∫°i) trong c√°c t√¨nh hu·ªëng th·ª±c t·∫ø (ƒëo chi·ªÅu cao, kho·∫£ng c√°ch)." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n ƒëo ƒë·∫°c ph·ª©c t·∫°p (nh∆∞ t√¨m kho·∫£ng c√°ch gi·ªØa hai ƒëi·ªÉm kh√≥ ƒëo) b·∫±ng c√°ch k·∫øt h·ª£p nhi·ªÅu y·∫øu t·ªë." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG IV. VECTO", 
      group: 10, 
      color: '#9999ff', 
      val: 10, 
      type: 'chapter', 
      description: "Kh√°i ni·ªám vect∆°, c√°c ph√©p to√°n v√† t√≠ch v√¥ h∆∞·ªõng", 
      prerequisites: [], 
      applications: ["CH∆Ø∆†NG VII. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG M·∫∂T PH·∫≤NG", "CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
        { name: "C√°c kh√°i ni·ªám m·ªü ƒë·∫ßu" }, 
        { name: "T·ªïng v√† hi·ªáu vect∆°" }, 
        { name: "T√≠ch vect∆° v·ªõi s·ªë" }, 
        { name: "Vect∆° trong m·∫∑t ph·∫≥ng to·∫° ƒë·ªô" }, 
        { name: "T√≠ch v√¥ h∆∞·ªõng" },
        createConsolidationPracticeDetailed("IV", [
            { level: "Th√¥ng hi·ªÉu", content: "Th·ª±c hi·ªán c√°c ph√©p to√°n vect∆° (c·ªông, tr·ª´, nh√¢n v·ªõi s·ªë) v√† ch·ª©ng minh c√°c ƒë·∫≥ng th·ª©c vect∆° c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng", content: "S·ª≠ d·ª•ng vect∆° ƒë·ªÉ ch·ª©ng minh c√°c quan h·ªá h√¨nh h·ªçc (th·∫≥ng h√†ng, vu√¥ng g√≥c, song song) v√† t√≠nh to√°n t·ªça ƒë·ªô, ƒë·ªô d√†i, g√≥c." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n qu·ªπ t√≠ch, t√¨m ƒëi·ªÉm, t·ªëi ∆∞u h√≥a c√≥ li√™n quan ƒë·∫øn bi·ªÉu th·ª©c vect∆° ho·∫∑c t√≠ch v√¥ h∆∞·ªõng trong m·∫∑t ph·∫≥ng." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG V. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG C·ª¶A M·∫™U S·ªê LI·ªÜU KH√îNG GH√âP NH√ìM", 
      group: 10, 
      color: '#9999ff', 
      val: 7, 
      type: 'chapter', 
      description: "C√°c s·ªë ƒë·∫∑c tr∆∞ng ƒëo xu th·∫ø trung t√¢m v√† ƒë·ªô ph√¢n t√°n", 
      prerequisites: [], 
      applications: ["CH∆Ø∆†NG III. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG ƒêO XU TH·∫æ TRUNG T√ÇM C·ª¶A M·∫™U S·ªê LI·ªÜU GH√âP NH√ìM"],
      lessons: [
        { name: "S·ªë g·∫ßn ƒë√∫ng v√† sai s·ªë" }, 
        { name: "S·ªë ƒë·∫∑c tr∆∞ng ƒëo xu th·∫ø trung t√¢m" }, 
        { name: "S·ªë ƒë·∫∑c tr∆∞ng ƒëo ƒë·ªô ph√¢n t√°n" },
        createConsolidationPracticeDetailed("V", [
            { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh s·ªë quy tr√≤n, sai s·ªë tuy·ªát ƒë·ªëi v√† sai s·ªë t∆∞∆°ng ƒë·ªëi c·ªßa s·ªë g·∫ßn ƒë√∫ng." },
            { level: "V·∫≠n d·ª•ng", content: "T√≠nh to√°n v√† so s√°nh c√°c s·ªë ƒë·∫∑c tr∆∞ng (trung b√¨nh, trung v·ªã, ph∆∞∆°ng sai, ƒë·ªô l·ªách chu·∫©n) c·ªßa c√°c m·∫´u s·ªë li·ªáu ƒë·ªÉ ƒë∆∞a ra nh·∫≠n x√©t." },
            { level: "V·∫≠n d·ª•ng cao", content: "Ph√¢n t√≠ch v√† gi·∫£i th√≠ch √Ω nghƒ©a c·ªßa c√°c ch·ªâ s·ªë th·ªëng k√™ trong ng·ªØ c·∫£nh th·ª±c t·∫ø (v√≠ d·ª•: so s√°nh k·∫øt qu·∫£ h·ªçc t·∫≠p, ƒë√°nh gi√° ch·∫•t l∆∞·ª£ng)." }
        ])
      ]
    },
    
    // ===================================
    // === C√ÅC CH∆Ø∆†NG L·ªöP 10 GI·ªÆ NGUY√äN ===
    // ===================================

    { 
      id: "CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG", 
      group: 10, 
      color: '#9999ff', 
      val: 11, 
      type: 'chapter', 
      description: "Kh√°i ni·ªám h√†m s·ªë, t√≠nh ch·∫•t v√† ƒë·ªì th·ªã - N·ªÅn t·∫£ng c·ªßa Gi·∫£i t√≠ch", 
      prerequisites: ["CH∆Ø∆†NG I. M·ªÜNH ƒê·ªÄ V√Ä T·∫¨P H·ª¢P"], 
      applications: ["CH∆Ø∆†NG II. D√ÉY S·ªê. C·∫§P S·ªê C·ªòNG V√Ä C·∫§P S·ªê NH√ÇN", "CH∆Ø∆†NG V. GI·ªöI H·∫†N. H√ÄM S·ªê LI√äN T·ª§C", "CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG I. H√ÄM S·ªê L∆Ø·ª¢NG GI√ÅC V√Ä PH∆Ø∆†NG TR√åNH L∆Ø·ª¢NG GI√ÅC", "CH∆Ø∆†NG VI. H√ÄM S·ªê M≈® V√Ä H√ÄM S·ªê L√îGARIT"],
      lessons: [
        { name: "B√†i 15. H√†m s·ªë", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt gi√° tr·ªã c·ªßa h√†m s·ªë d·ª±a v√†o b·∫£ng gi√° tr·ªã." }, { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ƒë∆∞·ª£c kho·∫£ng ƒë·ªìng bi·∫øn, ngh·ªãch bi·∫øn c·ªßa h√†m s·ªë d·ª±a v√†o ƒë·ªì th·ªã h√†m s·ªë." }, { level: "Th√¥ng hi·ªÉu", content: "M√¥ t·∫£ c√°c kh√°i ni·ªám c∆° b·∫£n v·ªÅ h√†m s·ªë: ƒë·ªãnh nghƒ©a h√†m s·ªë, t·∫≠p x√°c ƒë·ªãnh, t·∫≠p gi√° tr·ªã, h√†m s·ªë ƒë·ªìng bi·∫øn, h√†m s·ªë ngh·ªãch bi·∫øn, ƒë·ªì th·ªã c·ªßa h√†m s·ªë." }, { level: "Th√¥ng hi·ªÉu", content: "M√¥ t·∫£ c√°c ƒë·∫∑c tr∆∞ng h√¨nh h·ªçc c·ªßa ƒë·ªì th·ªã h√†m s·ªë ƒë·ªìng bi·∫øn, h√†m s·ªë ngh·ªãch bi·∫øn." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ki·∫øn th·ª©c c·ªßa h√†m s·ªë v√†o gi·∫£i quy·∫øt b√†i to√°n th·ª±c ti·ªÖn." } ] },
        { name: "B√†i 16. H√†m s·ªë b·∫≠c hai", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt c√°c t√≠nh ch·∫•t c∆° b·∫£n c·ªßa parabol nh∆∞ ƒë·ªânh, tr·ª•c ƒë·ªëi x·ª©ng." }, { level: "Th√¥ng hi·ªÉu", content: "Gi·∫£i th√≠ch ƒë∆∞·ª£c c√°c t√≠nh ch·∫•t c·ªßa h√†m s·ªë b·∫≠c hai th√¥ng qua ƒë·ªì th·ªã." }, { level: "Th√¥ng hi·ªÉu", content: "V·∫Ω ƒë∆∞·ª£c parabol l√† ƒë·ªì th·ªã h√†m s·ªë b·∫≠c hai." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ki·∫øn th·ª©c v·ªÅ h√†m s·ªë b·∫≠c hai v√† ƒë·ªì th·ªã v√†o gi·∫£i quy·∫øt b√†i to√°n th·ª±c ti·ªÖn." } ] },
        { name: "B√†i 17. D·∫•u c·ªßa tam th·ª©c b·∫≠c hai", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ƒë·ªãnh l√≠ v·ªÅ d·∫•u c·ªßa tam th·ª©c b·∫≠c hai." }, { level: "Th√¥ng hi·ªÉu", content: "Gi·∫£i th√≠ch ƒë·ªãnh l√≠ v·ªÅ d·∫•u c·ªßa tam th·ª©c b·∫≠c hai t·ª´ vi·ªác quan s√°t ƒë·ªì th·ªã c·ªßa h√†m s·ªë b·∫≠c hai." }, { level: "Th√¥ng hi·ªÉu", content: "Gi·∫£i b·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c hai." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng b·∫•t ph∆∞∆°ng tr√¨nh b·∫≠c hai m·ªôt ·∫©n v√†o gi·∫£i quy·∫øt b√†i to√°n th·ª±c ti·ªÖn." } ] },
        { name: "B√†i 18. Ph∆∞∆°ng tr√¨nh quy v·ªÅ ph∆∞∆°ng tr√¨nh b·∫≠c hai", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt nghi·ªám c·ªßa ph∆∞∆°ng tr√¨nh ch·ª©a cƒÉn (2 d·∫°ng trong SGK)." }, { level: "Th√¥ng hi·ªÉu", content: "Gi·∫£i ph∆∞∆°ng tr√¨nh ch·ª©a cƒÉn (2 d·∫°ng trong SGK)." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ƒë∆∞·ª£c ki·∫øn th·ª©c v√†o gi·∫£i c√°c b√†i to√°n li√™n quan th·ª±c t·∫ø." } ] },
        {
          name: "B√†i t·∫≠p cu·ªëi ch∆∞∆°ng VI",
          type: 'consolidation_practice',
          color: '#ffd700',
          val: 5,
          learning_objectives: [ { level: "V·∫≠n d·ª•ng", content: "T√≠ch h·ª£p ki·∫øn th·ª©c v·ªÅ h√†m s·ªë, ƒë·ªì th·ªã, d·∫•u tam th·ª©c b·∫≠c hai ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n t·ªïng h·ª£p." }, { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n th·ª±c t·∫ø ph·ª©c t·∫°p li√™n quan ƒë·∫øn to√†n b·ªô n·ªôi dung ch∆∞∆°ng." } ]
        }
      ] 
    },
    { 
      id: "CH∆Ø∆†NG VII. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG M·∫∂T PH·∫≤NG", 
      group: 10, 
      color: '#9999ff', 
      val: 10, 
      type: 'chapter', 
      description: "ƒê·∫°i s·ªë h√≥a h√¨nh h·ªçc ph·∫≥ng b·∫±ng h·ªá to·∫° ƒë·ªô", 
      prerequisites: ["CH∆Ø∆†NG IV. VECTO"], 
      applications: ["CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN", "CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
          { name: "B√†i 19. Ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Vect∆° ph√°p tuy·∫øn ho·∫∑c vect∆° ch·ªâ ph∆∞∆°ng c·ªßa ƒë∆∞·ªùng th·∫≥ng." }, { level: "Nh·∫≠n bi·∫øt", content: "ƒêi·ªÉm thu·ªôc (kh√¥ng thu·ªôc) ƒë∆∞·ªùng th·∫≥ng."}, { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n d·∫°ng ph∆∞∆°ng tr√¨nh tham s·ªë c·ªßa ƒë∆∞·ªùng th·∫≥ng khi bi·∫øt ƒë∆∞·ªùng th·∫≥ng ƒëi qua 1 ƒëi·ªÉm v√† nh·∫≠n 1 vect∆° ch·ªâ ph∆∞∆°ng." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh t·ªïng qu√°t c·ªßa ƒë∆∞·ªùng th·∫≥ng khi bi·∫øt ƒë∆∞·ªùng th·∫≥ng ƒëi qua 1 ƒëi·ªÉm v√† nh·∫≠n 1 vect∆° ph√°p tuy·∫øn." }, { level: "Th√¥ng hi·ªÉu", content: "Vi·∫øt ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng ƒëi qua 2 ƒëi·ªÉm cho tr∆∞·ªõc." }, { level: "Th√¥ng hi·ªÉu", content: "Chuy·ªÉn d·∫°ng ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng (t·ª´ d·∫°ng tham s·ªë sang d·∫°ng t·ªïng qu√°t v√† ng∆∞·ª£c l·∫°i)." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng c√°c ki·∫øn th·ª©c t·ªïng h·ª£p ƒë·ªÉ vi·∫øt ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng." }, { level: "V·∫≠n d·ª•ng cao", content: "Vi·∫øt ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng th·ªèa m√£n c√°c ƒëi·ªÅu ki·ªán ph·ª©c t·∫°p (v√≠ d·ª•: li√™n quan ƒë·∫øn di·ªán t√≠ch, kho·∫£ng c√°ch, ƒë∆∞·ªùng ph√¢n gi√°c...)." } ] },
          { name: "B√†i 20. V·ªã tr√≠ t∆∞∆°ng ƒë·ªëi gi·ªØa hai ƒë∆∞·ªùng th·∫≥ng. G√≥c v√† kho·∫£ng c√°ch", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi gi·ªØa hai ƒë∆∞·ªùng th·∫≥ng." }, { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt c√¥ng th·ª©c t√≠nh kho·∫£ng c√°ch t·ª´ m·ªôt ƒëi·ªÉm ƒë·∫øn m·ªôt ƒë∆∞·ªùng th·∫≥ng." }, { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt c√¥ng th·ª©c t√≠nh g√≥c gi·ªØa hai ƒë∆∞·ªùng th·∫≥ng." }, { level: "Th√¥ng hi·ªÉu", content: "T√≠nh kho·∫£ng c√°ch t·ª´ m·ªôt ƒëi·ªÉm ƒë·∫øn m·ªôt ƒë∆∞·ªùng th·∫≥ng." }, { level: "Th√¥ng hi·ªÉu", content: "T√≠nh g√≥c gi·ªØa hai ƒë∆∞·ªùng th·∫≥ng." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi gi·ªØa hai ƒë∆∞·ªùng th·∫≥ng." }, { level: "Th√¥ng hi·ªÉu", content: "T√¨m giao ƒëi·ªÉm c·ªßa hai ƒë∆∞·ªùng th·∫≥ng." }, { level: "Th√¥ng hi·ªÉu", content: "T√¨m ƒëi·ªÅu ki·ªán ƒë·ªÉ hai ƒë∆∞·ªùng th·∫≥ng song song ho·∫∑c vu√¥ng g√≥c." } ] },
          { name: "B√†i 21. ƒê∆∞·ªùng tr√≤n trong m·∫∑t ph·∫≥ng t·ªça ƒë·ªô", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n." }, { level: "Nh·∫≠n bi·∫øt", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c t√¢m v√† b√°n k√≠nh ƒë∆∞·ªùng tr√≤n khi bi·∫øt ph∆∞∆°ng tr√¨nh c·ªßa n√≥." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n khi bi·∫øt t√¢m v√† b√°n k√≠nh cho tr∆∞·ªõc." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n khi bi·∫øt t√¢m v√† ƒëi·ªÉm ƒëi qua." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n khi bi·∫øt ƒë∆∞·ªùng k√≠nh AB." }, { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n khi bi·∫øt t√¢m v√† ti·∫øp x√∫c v·ªõi ƒë∆∞·ªùng th·∫≥ng cho tr∆∞·ªõc." }, { level: "Th√¥ng hi·ªÉu", content: "Vi·∫øt ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ti·∫øp tuy·∫øn c·ªßa ƒë∆∞·ªùng tr√≤n t·∫°i ƒëi·ªÉm thu·ªôc ƒë∆∞·ªùng tr√≤n." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ki·∫øn th·ª©c v·ªÅ ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng tr√≤n ƒë·ªÉ gi·∫£i m·ªôt s·ªë b√†i to√°n li√™n quan ƒë·∫øn th·ª±c ti·ªÖn." } ] },
          { name: "B√†i 22. Ba ƒë∆∞·ªùng conic", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ƒë∆∞·ª£c ba ƒë∆∞·ªùng conic b·∫±ng h√¨nh h·ªçc." }, { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ph∆∞∆°ng tr√¨nh ch√≠nh t·∫Øc c·ªßa ba ƒë∆∞·ªùng conic trong m·∫∑t ph·∫≥ng to·∫° ƒë·ªô." }, { level: "Th√¥ng hi·ªÉu", content: "Vi·∫øt ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh ba ƒë∆∞·ªùng conic." }, { level: "V·∫≠n d·ª•ng", content: "Gi·∫£i quy·∫øt m·ªôt s·ªë v·∫•n ƒë·ªÅ th·ª±c ti·ªÖn v·ªõi ba ƒë∆∞·ªùng conic." } ] },
          {
              name: "B√†i t·∫≠p cu·ªëi ch∆∞∆°ng VII",
              type: 'consolidation_practice',
              color: '#ffd700',
              val: 5,
              learning_objectives: [ { level: "V·∫≠n d·ª•ng", content: "Ph·ªëi h·ª£p ki·∫øn th·ª©c v·ªÅ ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng, ƒë∆∞·ªùng tr√≤n v√† conic ƒë·ªÉ gi·∫£i c√°c b√†i to√°n h√¨nh h·ªçc t·ªça ƒë·ªô." }, { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n t√¨m ƒëi·ªÉm, qu·ªπ t√≠ch, t·ªëi ∆∞u h√≥a c√≥ y·∫øu t·ªë h√¨nh h·ªçc t·ªça ƒë·ªô." } ]
          }
      ]
    },
    { 
      id: "CH∆Ø∆†NH VIII. ƒê·∫†I S·ªê T·ªî H·ª¢P", 
      group: 10, 
      color: '#9999ff', 
      val: 9, 
      type: 'chapter', 
      description: "Ngh·ªá thu·∫≠t ƒë·∫øm: Ho√°n v·ªã, Ch·ªânh h·ª£p, T·ªï h·ª£p", 
      prerequisites: [], 
      applications: ["CH∆Ø∆†NG IX. T√çNH X√ÅC SU·∫§T THEO ƒê·ªäNH NGHƒ®A C·ªî ƒêI·ªÇN", "CH∆Ø∆†NG VIII. C√ÅC QUY T·∫ÆC T√çNH X√ÅC SU·∫§T", "CH∆Ø∆†NG VI. X√ÅC SU·∫§T C√ì ƒêI·ªÄU KI·ªÜN"],
      lessons: [
          { name: "B√†i 23. Quy t·∫Øc ƒë·∫øm", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt v√† ph√¢n bi·ªát ƒë∆∞·ª£c quy t·∫Øc c·ªông v√† quy t·∫Øc nh√¢n." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ƒë∆∞·ª£c quy t·∫Øc c·ªông v√† quy t·∫Øc nh√¢n trong c√°c b√†i to√°n ƒë∆°n gi·∫£n." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ƒë∆∞·ª£c s∆° ƒë·ªì c√¢y v·ªõi c√°c b√†i to√°n ƒë·∫øm c∆° b·∫£n l√† c√°c ƒë·ªëi t∆∞·ª£ng to√°n h·ªçc." } ] },
          { name: "B√†i 24. Ho√°n v·ªã, ch·ªânh h·ª£p v√† t·ªï h·ª£p", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a ho√°n v·ªã, ch·ªânh h·ª£p v√† t·ªï h·ª£p." }, { level: "Th√¥ng hi·ªÉu", content: "T√≠nh s·ªë c√°c ho√°n v·ªã, ch·ªânh h·ª£p v√† t·ªï h·ª£p." }, { level: "Th√¥ng hi·ªÉu", content: "T√≠nh s·ªë c√°c ho√°n v·ªã, ch·ªânh h·ª£p, t·ªï h·ª£p b·∫±ng m√°y t√≠nh c·∫ßm tay." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng ho√°n v·ªã, ch·ªânh h·ª£p v√† t·ªï h·ª£p v√†o b√†i to√°n th·ª±c ti·ªÖn." } ] },
          { name: "B√†i 25. Nh·ªã th·ª©c Newton", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt ƒë∆∞·ª£c c√¥ng th·ª©c t·ªïng qu√°t c·ªßa nh·ªã th·ª©c Newton." }, { level: "Th√¥ng hi·ªÉu", content: "T√¨m ƒë∆∞·ª£c h·ªá s·ªë c·ªßa c√°c s·ªë h·∫°ng trong khai tri·ªÉn nh·ªã th·ª©c Newton (a+b)^n v·ªõi s·ªë m≈© th·∫•p b·∫±ng c√°ch v·∫≠n d·ª•ng t·ªï h·ª£p." }, { level: "V·∫≠n d·ª•ng", content: "V·∫≠n d·ª•ng nh·ªã th·ª©c Newton ƒë·ªÉ t√≠nh t·ªïng, t√¨m tham s·ªë th·ªèa m√£n m·ªôt ƒëi·ªÅu ki·ªán cho tr∆∞·ªõc." } ] },
          {
              name: "B√†i t·∫≠p cu·ªëi ch∆∞∆°ng VIII",
              type: 'consolidation_practice',
              color: '#ffd700',
              val: 5,
              learning_objectives: [ { level: "V·∫≠n d·ª•ng", content: "Ph√¢n bi·ªát v√† √°p d·ª•ng linh ho·∫°t c√°c quy t·∫Øc ƒë·∫øm, ho√°n v·ªã, ch·ªânh h·ª£p, t·ªï h·ª£p trong c√°c b√†i to√°n ph·ª©c t·∫°p." }, { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n ƒë·∫øm c√≥ ƒëi·ªÅu ki·ªán r√†ng bu·ªôc, k·∫øt h·ª£p nh·ªã th·ª©c Newton." } ]
          }
      ]
    },
    { 
      id: "CH∆Ø∆†NG IX. T√çNH X√ÅC SU·∫§T THEO ƒê·ªäNH NGHƒ®A C·ªî ƒêI·ªÇN", 
      group: 10, 
      color: '#9999ff', 
      val: 9, 
      type: 'chapter', 
      description: "ƒê·ªãnh nghƒ©a x√°c su·∫•t: P(A) = |A| / |Œ©|", 
      prerequisites: ["CH∆Ø∆†NH VIII. ƒê·∫†I S·ªê T·ªî H·ª¢P", "CH∆Ø∆†NG I. M·ªÜNH ƒê·ªÄ V√Ä T·∫¨P H·ª¢P"], 
      applications: ["CH∆Ø∆†NG VIII. C√ÅC QUY T·∫ÆC T√çNH X√ÅC SU·∫§T"],
      lessons: [
          { name: "B√†i 26. Bi·∫øn c·ªë v√† ƒë·ªãnh nghƒ©a c·ªï ƒëi·ªÉn c·ªßa x√°c su·∫•t", learning_objectives: [ { level: "Nh·∫≠n bi·∫øt", content: "Nh·∫≠n bi·∫øt m·ªôt s·ªë kh√°i ni·ªám v·ªÅ x√°c su·∫•t c·ªï ƒëi·ªÉn, ph√©p th·ª≠ ng·∫´u nhi√™n, kh√¥ng gian m·∫´u v√† bi·∫øn c·ªë." }, { level: "Th√¥ng hi·ªÉu", content: "M√¥ t·∫£ kh√¥ng gian m·∫´u, bi·∫øn c·ªë trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p ƒë∆°n gi·∫£n." } ] },
          { name: "B√†i 27. Th·ª±c h√†nh t√≠nh x√°c su·∫•t theo ƒë·ªãnh nghƒ©a c·ªï ƒëi·ªÉn", learning_objectives: [ { level: "Th√¥ng hi·ªÉu", content: "T√≠nh ƒë∆∞·ª£c s·ªë k·∫øt qu·∫£ thu·∫≠n l·ª£i cho bi·∫øn c·ªë." }, { level: "V·∫≠n d·ª•ng", content: "T√≠nh x√°c su·∫•t c·ªßa bi·∫øn c·ªë trong m·ªôt s·ªë b√†i to√°n ƒë∆°n gi·∫£n b·∫±ng ph∆∞∆°ng ph√°p t·ªï h·ª£p." }, { level: "V·∫≠n d·ª•ng", content: "T√≠nh x√°c su·∫•t trong m·ªôt s·ªë th√≠ nghi·ªám l·∫∑p b·∫±ng c√°ch s·ª≠ d·ª•ng s∆° ƒë·ªì h√¨nh c√¢y." }, { level: "V·∫≠n d·ª•ng", content: "T√≠nh x√°c su·∫•t c·ªßa bi·∫øn c·ªë ƒë·ªëi." } ] },
          {
              name: "B√†i t·∫≠p cu·ªëi ch∆∞∆°ng IX",
              type: 'consolidation_practice',
              color: '#ffd700',
              val: 5,
              learning_objectives: [ { level: "V·∫≠n d·ª•ng", content: "Gi·∫£i c√°c b√†i to√°n x√°c su·∫•t t·ªïng h·ª£p y√™u c·∫ßu s·ª≠ d·ª•ng th√†nh th·∫°o c√°c quy t·∫Øc ƒë·∫øm v√† t·ªï h·ª£p." }, { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n x√°c su·∫•t li√™n quan ƒë·∫øn c√°c m√¥ h√¨nh th·ª±c t·∫ø." } ]
          }
      ]
    },
    
    // L·ªöP 11
    { 
      id: "CH∆Ø∆†NG I. H√ÄM S·ªê L∆Ø·ª¢NG GI√ÅC V√Ä PH∆Ø∆†NG TR√åNH L∆Ø·ª¢NG GI√ÅC", 
      group: 11, 
      color: '#f5d442', 
      val: 11, 
      type: 'chapter', 
      description: "H√†m tu·∫ßn ho√†n v√† ph∆∞∆°ng tr√¨nh l∆∞·ª£ng gi√°c", 
      prerequisites: ["CH∆Ø∆†NG III. H·ªÜ TH·ª®C L∆Ø·ª¢NG TRONG TAM GI√ÅC", "CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG"], 
      applications: ["CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG IV. NGUY√äN H√ÄM V√Ä T√çCH PH√ÇN"],
      lessons: [
        { name: "Gi√° tr·ªã l∆∞·ª£ng gi√°c c·ªßa g√≥c l∆∞·ª£ng gi√°c" }, 
        { name: "C√¥ng th·ª©c l∆∞·ª£ng gi√°c" }, 
        { name: "H√†m s·ªë l∆∞·ª£ng gi√°c" }, 
        { name: "Ph∆∞∆°ng tr√¨nh l∆∞·ª£ng gi√°c c∆° b·∫£n" },
        createConsolidationPracticeDetailed("I", [
            { level: "Th√¥ng hi·ªÉu", content: "S·ª≠ d·ª•ng c√°c c√¥ng th·ª©c l∆∞·ª£ng gi√°c ƒë·ªÉ r√∫t g·ªçn bi·ªÉu th·ª©c, t√≠nh gi√° tr·ªã l∆∞·ª£ng gi√°c c·ªßa g√≥c." },
            { level: "V·∫≠n d·ª•ng", content: "Gi·∫£i c√°c ph∆∞∆°ng tr√¨nh l∆∞·ª£ng gi√°c c∆° b·∫£n v√† c√°c d·∫°ng ph∆∞∆°ng tr√¨nh ƒë∆∞a v·ªÅ c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c ph∆∞∆°ng tr√¨nh l∆∞·ª£ng gi√°c ph·ª©c t·∫°p, bi·ªán lu·∫≠n theo tham s·ªë ho·∫∑c ·ª©ng d·ª•ng v√†o c√°c b√†i to√°n v·∫≠t l√Ω." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG II. D√ÉY S·ªê. C·∫§P S·ªê C·ªòNG V√Ä C·∫§P S·ªê NH√ÇN", 
      group: 11, 
      color: '#f5d442', 
      val: 9, 
      type: 'chapter', 
      description: "H√†m s·ªë v·ªõi t·∫≠p x√°c ƒë·ªãnh l√† s·ªë nguy√™n d∆∞∆°ng", 
      prerequisites: ["CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG"], 
      applications: ["CH∆Ø∆†NG V. GI·ªöI H·∫†N. H√ÄM S·ªê LI√äN T·ª§C"],
      lessons: [
        { name: "D√£y s·ªë" }, 
        { name: "C·∫•p s·ªë c·ªông" }, 
        { name: "C·∫•p s·ªë nh√¢n" },
        createConsolidationPracticeDetailed("II", [
            { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh t√≠nh ƒë∆°n ƒëi·ªáu, t√≠nh b·ªã ch·∫∑n c·ªßa d√£y s·ªë v√† ch·ª©ng minh m·ªôt d√£y l√† c·∫•p s·ªë c·ªông/nh√¢n." },
            { level: "V·∫≠n d·ª•ng", content: "X√°c ƒë·ªãnh c√°c y·∫øu t·ªë c·ªßa c·∫•p s·ªë (s·ªë h·∫°ng, c√¥ng sai/c√¥ng b·ªôi, t·ªïng) khi bi·∫øt c√°c ƒëi·ªÅu ki·ªán r√†ng bu·ªôc." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n th·ª±c t·∫ø (l√£i su·∫•t, tƒÉng tr∆∞·ªüng, suy gi·∫£m) c√≥ s·ª≠ d·ª•ng c√¥ng th·ª©c c·ªßa c·∫•p s·ªë nh√¢n/c·ªông." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG III. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG ƒêO XU TH·∫æ TRUNG T√ÇM C·ª¶A M·∫™U S·ªê LI·ªÜU GH√âP NH√ìM", 
      group: 11, 
      color: '#f5d442', 
      val: 7, 
      type: 'chapter', 
      description: "Th·ªëng k√™ cho d·ªØ li·ªáu gh√©p nh√≥m", 
      prerequisites: ["CH∆Ø∆†NG V. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG C·ª¶A M·∫™U S·ªê LI·ªÜU KH√îNG GH√âP NH√ìM"], 
      applications: ["CH∆Ø∆†NG III. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG ƒêO M·ª®C ƒê·ªò PH√ÇN T√ÅN C·ª¶A M·∫™U S·ªê LI·ªÜU GH√âP NH√ìM"],
      lessons: [
        { name: "M·∫´u s·ªë li·ªáu gh√©p nh√≥m" }, 
        { name: "S·ªë ƒë·∫∑c tr∆∞ng ƒëo xu th·∫ø trung t√¢m" },
        createConsolidationPracticeDetailed("III", [
            { level: "Th√¥ng hi·ªÉu", content: "T√≠nh to√°n c√°c s·ªë ƒë·∫∑c tr∆∞ng (trung b√¨nh, trung v·ªã, mode) t·ª´ b·∫£ng ph√¢n b·ªë t·∫ßn s·ªë gh√©p nh√≥m." },
            { level: "V·∫≠n d·ª•ng", content: "ƒê√°nh gi√°, so s√°nh v√† ƒë∆∞a ra quy·∫øt ƒë·ªãnh d·ª±a tr√™n c√°c ch·ªâ s·ªë th·ªëng k√™ ƒëo xu th·∫ø trung t√¢m c·ªßa d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c gh√©p nh√≥m." },
            { level: "V·∫≠n d·ª•ng cao", content: "X√°c ƒë·ªãnh kho·∫£ng t·ª© ph√¢n v·ªã c·ªßa m·∫´u s·ªë li·ªáu gh√©p nh√≥m v√† gi·∫£i th√≠ch √Ω nghƒ©a c·ªßa n√≥ (ƒë√¢y l√† ch∆∞∆°ng L·ªõp 11 c≈©, LOs t∆∞∆°ng ·ª©ng v·ªõi n·ªôi dung hi·ªán h√†nh)." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG IV. QUAN H·ªÜ SONG SONG TRONG KH√îNG GIAN", 
      group: 11, 
      color: "#f5d442", 
      val: 10, 
      type: "chapter", 
      description: "Quan h·ªá song song gi·ªØa ƒë∆∞·ªùng th·∫≥ng v√† m·∫∑t ph·∫≥ng", 
      prerequisites: ["CH∆Ø∆†NG IV. VECTO", "CH∆Ø∆†NG VII. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG M·∫∂T PH·∫≤NG"], 
      applications: ["CH∆Ø∆†NG VII. QUAN H·ªÜ VU√îNG G√ìC TRONG KH√îNG GIAN", "CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN", "CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
        { name: "ƒê∆∞·ªùng th·∫≥ng v√† m·∫∑t ph·∫≥ng" }, 
        { name: "Hai ƒë∆∞·ªùng th·∫≥ng song song" }, 
        { name: "ƒê∆∞·ªùng th·∫≥ng song song m·∫∑t ph·∫≥ng" }, 
        { name: "Hai m·∫∑t ph·∫≥ng song song" }, 
        { name: "Ph√©p chi·∫øu song song" },
        createConsolidationPracticeDetailed("IV", [
            { level: "Th√¥ng hi·ªÉu", content: "T√¨m giao tuy·∫øn c·ªßa hai m·∫∑t ph·∫≥ng, giao ƒëi·ªÉm c·ªßa ƒë∆∞·ªùng th·∫≥ng v√† m·∫∑t ph·∫≥ng (d√πng quy t·∫Øc c∆° b·∫£n)." },
            { level: "V·∫≠n d·ª•ng", content: "X√°c ƒë·ªãnh v√† ch·ª©ng minh c√°c quan h·ªá song song (ƒë∆∞·ªùng-ƒë∆∞·ªùng, ƒë∆∞·ªùng-m·∫∑t, m·∫∑t-m·∫∑t) v√† t√¨m thi·∫øt di·ªán song song v·ªõi m·∫∑t ph·∫≥ng." },
            { level: "V·∫≠n d·ª•ng cao", content: "S·ª≠ d·ª•ng c√°c t√≠nh ch·∫•t h√¨nh h·ªçc kh√¥ng gian ƒë·ªÉ t√¨m t·∫≠p h·ª£p ƒëi·ªÉm, ƒë∆∞·ªùng th·∫≥ng song song trong c√°c h√¨nh ch√≥p, h√¨nh lƒÉng tr·ª• ph·ª©c t·∫°p." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG V. GI·ªöI H·∫†N. H√ÄM S·ªê LI√äN T·ª§C", 
      group: 11, 
      color: '#f5d442', 
      val: 11, 
      type: 'chapter', 
      description: "Kh√°i ni·ªám v√¥ c√πng b√© v√† v√¥ c√πng l·ªõn - N·ªÅn m√≥ng Gi·∫£i t√≠ch", 
      prerequisites: ["CH∆Ø∆†NG II. D√ÉY S·ªê. C·∫§P S·ªê C·ªòNG V√Ä C·∫§P S·ªê NH√ÇN", "CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG"], 
      applications: ["CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG I. ·ª®NG D·ª§NG ƒê·∫†O H√ÄM ƒê·ªÇ KH·∫¢O S√ÅT V√Ä V·∫º ƒê·ªí TH·ªä H√ÄM S·ªê"],
      lessons: [
        { name: "Gi·ªõi h·∫°n c·ªßa d√£y s·ªë" }, 
        { name: "Gi·ªõi h·∫°n c·ªßa h√†m s·ªë" }, 
        { name: "H√†m s·ªë li√™n t·ª•c" },
        createConsolidationPracticeDetailed("V", [
            { level: "Th√¥ng hi·ªÉu", content: "T√≠nh gi·ªõi h·∫°n c·ªßa d√£y s·ªë v√† h√†m s·ªë (d·∫°ng ƒëa th·ª©c, ph√¢n th·ª©c) b·∫±ng c√°c quy t·∫Øc c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng", content: "T√≠nh gi·ªõi h·∫°n c·ªßa h√†m s·ªë/d√£y s·ªë ·ªü v√¥ c·ª±c v√† t·∫°i m·ªôt ƒëi·ªÉm b·∫±ng c√°c ph∆∞∆°ng ph√°p kh·ª≠ d·∫°ng v√¥ ƒë·ªãnh (nh√¢n li√™n h·ª£p, chia t·ª≠ m·∫´u...)." },
            { level: "V·∫≠n d·ª•ng cao", content: "T√¨m tham s·ªë ƒë·ªÉ h√†m s·ªë li√™n t·ª•c tr√™n mi·ªÅn x√°c ƒë·ªãnh; s·ª≠ d·ª•ng t√≠nh li√™n t·ª•c ƒë·ªÉ ch·ª©ng minh ph∆∞∆°ng tr√¨nh c√≥ nghi·ªám trong m·ªôt kho·∫£ng." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG VI. H√ÄM S·ªê M≈® V√Ä H√ÄM S·ªê L√îGARIT", 
      group: 11, 
      color: '#f5d442', 
      val: 10, 
      type: 'chapter', 
      description: "Hai l·ªõp h√†m quan tr·ªçng trong th·ª±c t·∫ø", 
      prerequisites: ["CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG"], 
      applications: ["CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG IV. NGUY√äN H√ÄM V√Ä T√çCH PH√ÇN"],
      lessons: [
        { name: "L≈©y th·ª´a v·ªõi s·ªë m≈© th·ª±c" }, 
        { name: "Logarit" }, 
        { name: "H√†m s·ªë m≈© v√† logarit" }, 
        { name: "Ph∆∞∆°ng tr√¨nh, b·∫•t ph∆∞∆°ng tr√¨nh m≈© v√† logarit" },
        createConsolidationPracticeDetailed("VI", [
            { level: "Th√¥ng hi·ªÉu", content: "V·∫≠n d·ª•ng c√°c t√≠nh ch·∫•t c·ªßa l≈©y th·ª´a, l√¥garit ƒë·ªÉ r√∫t g·ªçn bi·ªÉu th·ª©c, t√≠nh gi√° tr·ªã." },
            { level: "V·∫≠n d·ª•ng", content: "Gi·∫£i c√°c ph∆∞∆°ng tr√¨nh, b·∫•t ph∆∞∆°ng tr√¨nh m≈© v√† l√¥garit b·∫±ng c√°c ph∆∞∆°ng ph√°p c∆° b·∫£n (ƒë∆∞a v·ªÅ c√πng c∆° s·ªë, ƒë·∫∑t ·∫©n ph·ª•, l√¥garit h√≥a)." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i ph∆∞∆°ng tr√¨nh/b·∫•t ph∆∞∆°ng tr√¨nh m≈©-l√¥garit c√≥ tham s·ªë ho·∫∑c ·ª©ng d·ª•ng v√†o c√°c m√¥ h√¨nh th·ª±c t·∫ø (tƒÉng tr∆∞·ªüng d√¢n s·ªë, l√£i su·∫•t k√©p, ph√¢n r√£)." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG VII. QUAN H·ªÜ VU√îNG G√ìC TRONG KH√îNG GIAN", 
      group: 11, 
      color: '#f5d442', 
      val: 11, 
      type: 'chapter', 
      description: "Quan h·ªá vu√¥ng g√≥c, kho·∫£ng c√°ch, g√≥c v√† th·ªÉ t√≠ch", 
      prerequisites: ["CH∆Ø∆†NG IV. QUAN H·ªÜ SONG SONG TRONG KH√îNG GIAN"], 
      applications: ["CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN", "CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
        { name: "Hai ƒë∆∞·ªùng th·∫≥ng vu√¥ng g√≥c" }, 
        { name: "ƒê∆∞·ªùng th·∫≥ng vu√¥ng g√≥c v·ªõi m·∫∑t ph·∫≥ng" }, 
        { name: "Ph√©p chi·∫øu vu√¥ng g√≥c" }, 
        { name: "Hai m·∫∑t ph·∫≥ng vu√¥ng g√≥c" }, 
        { name: "Kho·∫£ng c√°ch" }, 
        { name: "Th·ªÉ t√≠ch" },
        createConsolidationPracticeDetailed("VII", [
            { level: "Th√¥ng hi·ªÉu", content: "Ch·ª©ng minh c√°c quan h·ªá vu√¥ng g√≥c (ƒë∆∞·ªùng-ƒë∆∞·ªùng, ƒë∆∞·ªùng-m·∫∑t, m·∫∑t-m·∫∑t) v√† x√°c ƒë·ªãnh h√¨nh chi·∫øu vu√¥ng g√≥c." },
            { level: "V·∫≠n d·ª•ng", content: "T√≠nh g√≥c gi·ªØa ƒë∆∞·ªùng th·∫≥ng/m·∫∑t ph·∫≥ng, t√≠nh kho·∫£ng c√°ch (ƒëi·ªÉm-m·∫∑t, ƒë∆∞·ªùng-m·∫∑t) v√† t√≠nh th·ªÉ t√≠ch c√°c kh·ªëi ƒëa di·ªán c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n th·ªÉ t√≠ch kh·ªëi ƒëa di·ªán ph·ª©c t·∫°p (d√πng t·ªâ s·ªë th·ªÉ t√≠ch, c√¥ng th·ª©c kh·ªëi ch√≥p c·ª•t), x√°c ƒë·ªãnh g√≥c v√† kho·∫£ng c√°ch trong h√¨nh h·ªçc kh√¥ng gian c·ªï ƒëi·ªÉn." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG VIII. C√ÅC QUY T·∫ÆC T√çNH X√ÅC SU·∫§T", 
      group: 11, 
      color: '#f5d442', 
      val: 9, 
      type: 'chapter', 
      description: "Bi·∫øn c·ªë h·ª£p, giao, ƒë·ªôc l·∫≠p v√† c√¥ng th·ª©c c·ªông v√† nh√¢n", 
      prerequisites: ["CH∆Ø∆†NG IX. T√çNH X√ÅC SU·∫§T THEO ƒê·ªäNH NGHƒ®A C·ªî ƒêI·ªÇN", "CH∆Ø∆†NH VIII. ƒê·∫†I S·ªê T·ªî H·ª¢P"], 
      applications: ["CH∆Ø∆†NG VI. X√ÅC SU·∫§T C√ì ƒêI·ªÄU KI·ªÜN"],
      lessons: [
        { name: "Bi·∫øn c·ªë h·ª£p, giao, ƒë·ªôc l·∫≠p" }, 
        { name: "C√¥ng th·ª©c c·ªông x√°c su·∫•t" }, 
        { name: "C√¥ng th·ª©c nh√¢n x√°c su·∫•t" },
        createConsolidationPracticeDetailed("VIII", [
            { level: "Th√¥ng hi·ªÉu", content: "X√°c ƒë·ªãnh c√°c bi·∫øn c·ªë h·ª£p, giao, xung kh·∫Øc, ƒë·ªôc l·∫≠p v√† t√≠nh x√°c su·∫•t c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng", content: "√Åp d·ª•ng th√†nh th·∫°o c√¥ng th·ª©c c·ªông v√† nh√¢n x√°c su·∫•t (cho c·∫£ bi·∫øn c·ªë xung kh·∫Øc v√† kh√¥ng xung kh·∫Øc) ƒë·ªÉ t√≠nh x√°c su·∫•t t·ªïng h·ª£p." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i quy·∫øt c√°c b√†i to√°n x√°c su·∫•t t·ªïng h·ª£p, ƒë·∫∑c bi·ªát l√† b√†i to√°n li√™n quan ƒë·∫øn vi·ªác th·ª≠ nghi·ªám li√™n ti·∫øp v√† s·ª± ph·ª• thu·ªôc gi·ªØa c√°c bi·∫øn c·ªë." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", 
      group: 11, 
      color: '#f5d442', 
      val: 13, 
      type: 'chapter', 
      description: "C√¥ng c·ª• vi ph√¢n - Tr√°i tim c·ªßa Gi·∫£i t√≠ch THPT", 
      prerequisites: ["CH∆Ø∆†NG V. GI·ªöI H·∫†N. H√ÄM S·ªê LI√äN T·ª§C", "CH∆Ø∆†NG VI. H√ÄM S·ªê, ƒê·ªí TH·ªä V√Ä ·ª®NG D·ª§NG", "CH∆Ø∆†NG I. H√ÄM S·ªê L∆Ø·ª¢NG GI√ÅC V√Ä PH∆Ø∆†NG TR√åNH L∆Ø·ª¢NG GI√ÅC", "CH∆Ø∆†NG VI. H√ÄM S·ªê M≈® V√Ä H√ÄM S·ªê L√îGARIT"], 
      applications: ["CH∆Ø∆†NG I. ·ª®NG D·ª§NG ƒê·∫†O H√ÄM ƒê·ªÇ KH·∫¢O S√ÅT V√Ä V·∫º ƒê·ªí TH·ªä H√ÄM S·ªê", "CH∆Ø∆†NG IV. NGUY√äN H√ÄM V√Ä T√çCH PH√ÇN"],
      lessons: [
        { name: "ƒê·ªãnh nghƒ©a v√† √Ω nghƒ©a" }, 
        { name: "C√°c quy t·∫Øc t√≠nh ƒë·∫°o h√†m" }, 
        { name: "ƒê·∫°o h√†m c·∫•p hai" },
        createConsolidationPracticeDetailed("IX", [
            { level: "Th√¥ng hi·ªÉu", content: "T√≠nh ƒë·∫°o h√†m (c·∫•p 1, c·∫•p 2) c·ªßa c√°c h√†m s·ªë s∆° c·∫•p (m≈©, l√¥garit, l∆∞·ª£ng gi√°c) v√† h√†m s·ªë h·ª£p." },
            { level: "V·∫≠n d·ª•ng", content: "Vi·∫øt ph∆∞∆°ng tr√¨nh ti·∫øp tuy·∫øn c·ªßa ƒë·ªì th·ªã h√†m s·ªë t·∫°i m·ªôt ƒëi·ªÉm, v√† s·ª≠ d·ª•ng ƒë·∫°o h√†m ƒë·ªÉ gi·∫£i c√°c b√†i to√°n t·ªëc ƒë·ªô, gia t·ªëc." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n t√¨m tham s·ªë, t√≠nh gi·ªõi h·∫°n v√† ·ª©ng d·ª•ng ƒë·∫°o h√†m ƒë·ªÉ gi·∫£i quy·∫øt c√°c m√¥ h√¨nh chuy·ªÉn ƒë·ªông, kinh t·∫ø." }
        ])
      ]
    },
    
    // L·ªöP 12
    { 
      id: "CH∆Ø∆†NG I. ·ª®NG D·ª§NG ƒê·∫†O H√ÄM ƒê·ªÇ KH·∫¢O S√ÅT V√Ä V·∫º ƒê·ªí TH·ªä H√ÄM S·ªê", 
      group: 12, 
      color: '#ffd700', 
      val: 13, 
      type: 'chapter', 
      description: "Kh·∫£o s√°t v√† v·∫Ω ƒë·ªì th·ªã h√†m s·ªë", 
      prerequisites: ["CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG V. GI·ªöI H·∫†N. H√ÄM S·ªê LI√äN T·ª§C"], 
      applications: ["CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
        { name: "T√≠nh ƒë∆°n ƒëi·ªáu v√† c·ª±c tr·ªã" }, 
        { name: "Gi√° tr·ªã l·ªõn nh·∫•t v√† nh·ªè nh·∫•t" }, 
        { name: "ƒê∆∞·ªùng ti·ªám c·∫≠n" }, 
        { name: "Kh·∫£o s√°t h√†m s·ªë" }, 
        { name: "·ª®ng d·ª•ng th·ª±c ti·ªÖn" },
        createConsolidationPracticeDetailed("I", [
            { level: "Th√¥ng hi·ªÉu", content: "Kh·∫£o s√°t v√† v·∫Ω ƒë·ªì th·ªã c√°c h√†m s·ªë c∆° b·∫£n (b·∫≠c ba, tr√πng ph∆∞∆°ng, ph√¢n th·ª©c b·∫≠c nh·∫•t/b·∫≠c nh·∫•t)." },
            { level: "V·∫≠n d·ª•ng", content: "T√¨m kho·∫£ng ƒë∆°n ƒëi·ªáu, c·ª±c tr·ªã, ti·ªám c·∫≠n, gi√° tr·ªã l·ªõn nh·∫•t/nh·ªè nh·∫•t v√† bi·ªán lu·∫≠n s·ªë nghi·ªám c·ªßa ph∆∞∆°ng tr√¨nh b·∫±ng ph∆∞∆°ng ph√°p ƒë·ªì th·ªã." },
            { level: "V·∫≠n d·ª•ng cao", content: "T√¨m tham s·ªë ƒë·ªÉ h√†m s·ªë ƒë·∫°t c·ª±c tr·ªã, ƒë·ªìng bi·∫øn/ngh·ªãch bi·∫øn tr√™n m·ªôt kho·∫£ng cho tr∆∞·ªõc, ho·∫∑c gi·∫£i quy·∫øt c√°c b√†i to√°n t·ªëi ∆∞u h√≥a ph·ª©c t·∫°p." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN", 
      group: 12, 
      color: '#ff8c42', 
      val: 10, 
      type: 'chapter', 
      description: "M·ªü r·ªông vect∆° t·ª´ 2D l√™n 3D", 
      prerequisites: ["CH∆Ø∆†NG IV. VECTO", "CH∆Ø∆†NG VII. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG M·∫∂T PH·∫≤NG", "CH∆Ø∆†NG IV. QUAN H·ªÜ SONG SONG TRONG KH√îNG GIAN", "CH∆Ø∆†NG VII. QUAN H·ªÜ VU√îNG G√ìC TRONG KH√îNG GIAN"], 
      applications: ["CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN"],
      lessons: [
        { name: "Vect∆° trong kh√¥ng gian" }, 
        { name: "H·ªá tr·ª•c to·∫° ƒë·ªô trong kh√¥ng gian" }, 
        { name: "Bi·ªÉu th·ª©c to·∫° ƒë·ªô c·ªßa c√°c ph√©p to√°n vect∆°" },
        createConsolidationPracticeDetailed("II", [
            { level: "Th√¥ng hi·ªÉu", content: "Th·ª±c hi·ªán c√°c ph√©p to√°n vect∆°, x√°c ƒë·ªãnh t·ªça ƒë·ªô c·ªßa ƒëi·ªÉm, vect∆° trong h·ªá Oxyz." },
            { level: "V·∫≠n d·ª•ng", content: "S·ª≠ d·ª•ng t·ªça ƒë·ªô v√† t√≠ch v√¥ h∆∞·ªõng ƒë·ªÉ ch·ª©ng minh c√°c quan h·ªá vu√¥ng g√≥c, t√≠nh ƒë·ªô d√†i ƒëo·∫°n th·∫≥ng v√† t√¨m t·ªça ƒë·ªô ƒëi·ªÉm th·ªèa m√£n ƒëi·ªÅu ki·ªán vect∆°." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n t·ªïng h·ª£p v·ªÅ h√¨nh h·ªçc kh√¥ng gian (h√¨nh h·ªôp, t·ª© di·ªán) b·∫±ng ph∆∞∆°ng ph√°p vect∆° v√† t·ªça ƒë·ªô." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG III. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG ƒêO M·ª®C ƒê·ªò PH√ÇN T√ÅN C·ª¶A M·∫™U S·ªê LI·ªÜU GH√âP NH√ìM", 
      group: 12, 
      color: '#ff8c42', 
      val: 7, 
      type: 'chapter', 
      description: "Ho√†n thi·ªán Th·ªëng k√™ m√¥ t·∫£", 
      prerequisites: ["CH∆Ø∆†NG III. C√ÅC S·ªê ƒê·∫∂C TR∆ØNG ƒêO XU TH·∫æ TRUNG T√ÇM C·ª¶A M·∫™U S·ªê LI·ªÜU GH√âP NH√ìM"], 
      applications: [],
      lessons: [
        { name: "Kho·∫£ng bi·∫øn thi√™n v√† kho·∫£ng t·ª© ph√¢n v·ªã" }, 
        { name: "Ph∆∞∆°ng sai v√† ƒë·ªô l·ªách chu·∫©n" },
        createConsolidationPracticeDetailed("III", [
            { level: "Th√¥ng hi·ªÉu", content: "T√≠nh to√°n kho·∫£ng bi·∫øn thi√™n, kho·∫£ng t·ª© ph√¢n v·ªã, ph∆∞∆°ng sai v√† ƒë·ªô l·ªách chu·∫©n c·ªßa m·∫´u s·ªë li·ªáu gh√©p nh√≥m." },
            { level: "V·∫≠n d·ª•ng", content: "Ph√¢n t√≠ch m·ª©c ƒë·ªô ph√¢n t√°n c·ªßa d·ªØ li·ªáu v√† ƒë∆∞a ra nh·∫≠n x√©t chuy√™n s√¢u v·ªÅ t√≠nh ·ªïn ƒë·ªãnh, ƒë·ªìng nh·∫•t c·ªßa m·∫´u d·ªØ li·ªáu trong c√°c t√¨nh hu·ªëng th·ª±c t·∫ø." },
            { level: "V·∫≠n d·ª•ng cao", content: "So s√°nh ƒë·ªô ph√¢n t√°n c·ªßa hai m·∫´u s·ªë li·ªáu (v√≠ d·ª•: so s√°nh ch·∫•t l∆∞·ª£ng, th·ªùi gian) b·∫±ng c√°c ch·ªâ s·ªë th·ªëng k√™ ph√π h·ª£p." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG IV. NGUY√äN H√ÄM V√Ä T√çCH PH√ÇN", 
      group: 12, 
      color: '#ffd700', 
      val: 12, 
      type: 'chapter', 
      description: "Ph√©p to√°n ng∆∞·ª£c c·ªßa ƒë·∫°o h√†m", 
      prerequisites: ["CH∆Ø∆†NG IX. ƒê·∫†O H√ÄM", "CH∆Ø∆†NG I. H√ÄM S·ªê L∆Ø·ª¢NG GI√ÅC V√Ä PH∆Ø∆†NG TR√åNH L∆Ø·ª¢NG GI√ÅC", "CH∆Ø∆†NG VI. H√ÄM S·ªê M≈® V√Ä H√ÄM S·ªê L√îGARIT"], 
      applications: [],
      lessons: [
        { name: "Nguy√™n h√†m" }, 
        { name: "T√≠ch ph√¢n" }, 
        { name: "·ª®ng d·ª•ng h√¨nh h·ªçc c·ªßa t√≠ch ph√¢n" },
        createConsolidationPracticeDetailed("IV", [
            { level: "Th√¥ng hi·ªÉu", content: "T√¨m h·ªç nguy√™n h√†m, t√≠nh t√≠ch ph√¢n b·∫±ng c√°c ph∆∞∆°ng ph√°p ƒë·ªïi bi·∫øn s·ªë, t√≠ch ph√¢n t·ª´ng ph·∫ßn (c∆° b·∫£n)." },
            { level: "V·∫≠n d·ª•ng", content: "T√≠nh di·ªán t√≠ch h√¨nh ph·∫≥ng, th·ªÉ t√≠ch v·∫≠t th·ªÉ tr√≤n xoay v√† gi·∫£i c√°c b√†i to√°n v·∫≠n d·ª•ng th·ª±c t·∫ø (v·∫≠n t·ªëc, qu√£ng ƒë∆∞·ªùng, l√£i su·∫•t) b·∫±ng t√≠ch ph√¢n." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n t√¨m nguy√™n h√†m/t√≠ch ph√¢n th·ªèa m√£n ƒëi·ªÅu ki·ªán (c√≥ tham s·ªë) ho·∫∑c t√≠nh ·ª©ng d·ª•ng h√¨nh h·ªçc ph·ª©c t·∫°p (ch·ª©a tr·ªã tuy·ªát ƒë·ªëi, h√†m ·∫©n)." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG V. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG KH√îNG GIAN", 
      group: 12, 
      color: '#ff8c42', 
      val: 14, 
      type: 'chapter', 
      description: "ƒê·ªânh cao c·ªßa H√¨nh h·ªçc gi·∫£i t√≠ch", 
      prerequisites: ["CH∆Ø∆†NG II. VECT∆† V√Ä H·ªÜ TR·ª§C TO·∫† ƒê·ªò TRONG KH√îNG GIAN", "CH∆Ø∆†NG IV. QUAN H·ªÜ SONG SONG TRONG KH√îNG GIAN", "CH∆Ø∆†NG VII. QUAN H·ªÜ VU√îNG G√ìC TRONG KH√îNG GIAN", "CH∆Ø∆†NG VII. PH∆Ø∆†NG PH√ÅP TO·∫† ƒê·ªò TRONG M·∫∂T PH·∫≤NG", "CH∆Ø∆†NG I. ·ª®NG D·ª§NG ƒê·∫†O H√ÄM ƒê·ªÇ KH·∫¢O S√ÅT V√Ä V·∫º ƒê·ªí TH·ªä H√ÄM S·ªê"], 
      applications: [],
      lessons: [
        { name: "Ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng" }, 
        { name: "Ph∆∞∆°ng tr√¨nh ƒë∆∞·ªùng th·∫≥ng trong kh√¥ng gian" }, 
        { name: "C√¥ng th·ª©c t√≠nh g√≥c trong kh√¥ng gian" }, 
        { name: "Ph∆∞∆°ng tr√¨nh m·∫∑t c·∫ßu" },
        createConsolidationPracticeDetailed("V", [
            { level: "Th√¥ng hi·ªÉu", content: "Vi·∫øt ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng/ƒë∆∞·ªùng th·∫≥ng/m·∫∑t c·∫ßu c∆° b·∫£n v√† x√°c ƒë·ªãnh c√°c y·∫øu t·ªë (t√¢m, b√°n k√≠nh, vect∆° ph√°p tuy·∫øn/ch·ªâ ph∆∞∆°ng)." },
            { level: "V·∫≠n d·ª•ng", content: "T√≠nh kho·∫£ng c√°ch, g√≥c gi·ªØa c√°c ƒë·ªëi t∆∞·ª£ng v√† x√©t v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi gi·ªØa ƒë∆∞·ªùng th·∫≥ng - m·∫∑t ph·∫≥ng." },
            { level: "V·∫≠n d·ª•ng cao", content: "Gi·∫£i c√°c b√†i to√°n h√¨nh h·ªçc kh√¥ng gian c√≥ y·∫øu t·ªë t·ªëi ∆∞u (t√¨m ƒëi·ªÉm, m·∫∑t ph·∫≥ng th·ªèa m√£n ƒëi·ªÅu ki·ªán kho·∫£ng c√°ch/th·ªÉ t√≠ch nh·ªè nh·∫•t/l·ªõn nh·∫•t) b·∫±ng ph∆∞∆°ng ph√°p t·ªça ƒë·ªô." }
        ])
      ]
    },
    { 
      id: "CH∆Ø∆†NG VI. X√ÅC SU·∫§T C√ì ƒêI·ªÄU KI·ªÜN", 
      group: 12, 
      color: '#ff8c42', 
      val: 9, 
      type: 'chapter', 
      description: "ƒê·ªânh cao c·ªßa X√°c su·∫•t THPT", 
      prerequisites: ["CH∆Ø∆†NG VIII. C√ÅC QUY T·∫ÆC T√çNH X√ÅC SU·∫§T", "CH∆Ø∆†NH VIII. ƒê·∫†I S·ªê T·ªî H·ª¢P"], 
      applications: [],
      lessons: [
        { name: "X√°c su·∫•t c√≥ ƒëi·ªÅu ki·ªán" }, 
        { name: "C√¥ng th·ª©c x√°c su·∫•t to√†n ph·∫ßn v√† c√¥ng th·ª©c Bayes" },
        createConsolidationPracticeDetailed("VI", [
            { level: "Th√¥ng hi·ªÉu", content: "S·ª≠ d·ª•ng x√°c su·∫•t c√≥ ƒëi·ªÅu ki·ªán v√† c√¥ng th·ª©c nh√¢n x√°c su·∫•t cho c√°c b√†i to√°n c∆° b·∫£n." },
            { level: "V·∫≠n d·ª•ng", content: "√Åp d·ª•ng c√¥ng th·ª©c x√°c su·∫•t to√†n ph·∫ßn ƒë·ªÉ t√≠nh x√°c su·∫•t c·ªßa m·ªôt bi·∫øn c·ªë khi x·∫£y ra trong nhi·ªÅu tr∆∞·ªùng h·ª£p." },
            { level: "V·∫≠n d·ª•ng cao", content: "√Åp d·ª•ng c√¥ng th·ª©c Bayes ƒë·ªÉ t√≠nh x√°c su·∫•t ng∆∞·ª£c (t√≠nh x√°c su·∫•t c·ªßa nguy√™n nh√¢n khi ƒë√£ bi·∫øt k·∫øt qu·∫£) trong c√°c m√¥ h√¨nh th·ª±c t·∫ø (y h·ªçc, th·ªëng k√™)." }
        ])
      ]
    }
  ],
  links: []
};
    // ===================================
    // === B·∫ÆT ƒê·∫¶U PH·∫¶N SCRIPT ƒê√É S·ª¨A ===
    // ===================================

    const lessonNodes = [];
    fullKnowledgeData.nodes.forEach(chapter => {
      if (chapter.type === 'chapter' && chapter.lessons) {
        chapter.lessons.forEach((lesson, index) => {
          const lessonName = typeof lesson === 'object' ? lesson.name : lesson;
          
          // ‚ú® THAY ƒê·ªîI 1: N√¢ng c·∫•p logic ƒë·ªÉ l·∫•y c√°c thu·ªôc t√≠nh ri√™ng bi·ªát
          lessonNodes.push({
            id: `${chapter.id}_lesson_${index}`,
            name: lessonName,
            group: chapter.group,
            color: lesson.color || chapter.color, // ∆Øu ti√™n m√†u ri√™ng c·ªßa lesson
            val: lesson.val || 3, // ∆Øu ti√™n val ri√™ng c·ªßa lesson
            type: lesson.type || 'lesson', // ∆Øu ti√™n type ri√™ng c·ªßa lesson
            parentChapter: chapter.id
          });
        });
      }
    });

    fullKnowledgeData.nodes.push(...lessonNodes);
    
    const nodeMap = new Map(fullKnowledgeData.nodes.map(node => [node.id, node]));
    const linkTracker = new Set(); 

    // T·∫°o link Ph√¢n r√£ t·ª´ Ch∆∞∆°ng -> B√†i h·ªçc
    fullKnowledgeData.nodes.forEach(node => {
      // Ch·ªâ c·∫ßn t·∫°o link ph√¢n r√£ t·ª´ ch∆∞∆°ng cha ƒë·∫øn c√°c node con l√† ƒë·ªß
      if ((node.type === 'lesson' || node.type === 'consolidation_practice') && node.parentChapter && nodeMap.has(node.parentChapter)) {
        fullKnowledgeData.links.push({
          source: node.parentChapter,
          target: node.id,
          type: 'sub_knowledge'
        });
      }
    });

    // T·∫°o link Quan h·ªá (Ti√™n quy·∫øt & ·ª®ng d·ª•ng)
    fullKnowledgeData.nodes.forEach(node => {
      if (node.type === 'chapter') {
        if (node.prerequisites) {
          node.prerequisites.forEach(prereqId => {
            const linkKey = `${prereqId} -> ${node.id}`;
            if (nodeMap.has(prereqId) && !linkTracker.has(linkKey)) {
              fullKnowledgeData.links.push({ source: prereqId, target: node.id, type: "relationship" });
              linkTracker.add(linkKey);
            }
          });
        }
        if (node.applications) {
          node.applications.forEach(appId => {
            const linkKey = `${node.id} -> ${appId}`;
            if (nodeMap.has(appId) && !linkTracker.has(linkKey)) {
              fullKnowledgeData.links.push({ source: node.id, target: appId, type: "relationship" });
              linkTracker.add(linkKey);
            }
          });
        }
      }
    });

    const NEUTRAL_COLOR = 'rgba(50, 60, 100, 0.2)';
    const PREREQUISITE_COLOR = '#ff6961';
    const APPLICATION_COLOR = '#77dd77';
    const SUB_KNOWLEDGE_COLOR = '#6CA0DC';

    let selectedNode = null;
    let hoveredNode = null;
    let highlightNodes = new Set();
    let highlightLinks = new Set();
    let isNodeSelected = false;

    const chapterCount = fullKnowledgeData.nodes.filter(n => n.type === 'chapter').length;
    document.getElementById('total-chapters').textContent = chapterCount;
    document.getElementById('total-links').textContent = fullKnowledgeData.links.length;

    function calculateLinkWidth(link) {
      if (link.type === 'sub_knowledge') return 1;
      const sourceNode = fullKnowledgeData.nodes.find(n => n.id === (link.source.id || link.source));
      const targetNode = fullKnowledgeData.nodes.find(n => n.id === (link.target.id || link.target));
      if (sourceNode && targetNode && sourceNode.type === 'chapter' && targetNode.type === 'chapter') {
        const importance = (sourceNode.val + targetNode.val) / 6;
        return Math.max(2, Math.min(5, importance));
      }
      return 2;
    }

    function getLinkColor(link) {
        const sourceId = link.source.id || link.source;
        const targetId = link.target.id || link.target;
        const currentNodeId = selectedNode ? selectedNode.id : (hoveredNode ? hoveredNode.id : null);

        if (!currentNodeId || !highlightLinks.has(link)) {
            if (link.type === 'sub_knowledge') return SUB_KNOWLEDGE_COLOR;
            return NEUTRAL_COLOR;
        }
        if (link.type === 'sub_knowledge') return SUB_KNOWLEDGE_COLOR;

        const sourceNode = nodeMap.get(sourceId);
        const targetNode = nodeMap.get(targetId);

        if (sourceNode && targetNode) {
            if (currentNodeId === targetId && targetNode.prerequisites && targetNode.prerequisites.includes(sourceId)) {
                return PREREQUISITE_COLOR;
            }
            if (currentNodeId === sourceId && sourceNode.applications && sourceNode.applications.includes(targetId)) {
                return APPLICATION_COLOR;
            }
        }
        return NEUTRAL_COLOR;
    }
    
    const Graph = ForceGraph3D()
      (document.getElementById('graph-container'))
        .backgroundColor('#0a0e27')
        .graphData(fullKnowledgeData)
        .nodeLabel(node => (node.type === 'lesson' || node.type === 'consolidation_practice') ? node.name : node.id)
        .nodeVal('val')
        .nodeThreeObject(node => {
            const group = new THREE.Group();
            const geometry = new THREE.SphereGeometry(node.val, 16, 16); 
            const material = new THREE.MeshPhongMaterial({
                color: node.color,
                emissive: node.color,
                emissiveIntensity: 0.4,
                shininess: 100,
                specular: 0x444444,
                transparent: true,
                opacity: 0.95
            });
            const sphere = new THREE.Mesh(geometry, material);
            group.add(sphere);

            // ‚ú® THAY ƒê·ªîI 2: Th√™m logic x·ª≠ l√Ω hi·ªÉn th·ªã cho node 'consolidation_practice'
            if (node.type === 'chapter' || node.type === 'lesson' || node.type === 'consolidation_practice') {
                const text = node.type === 'chapter' ? node.id : node.name;
                
                const wrapText = (text, maxWidth) => {
                    if (text.length <= maxWidth) return text;
                    const words = text.split(' ');
                    let lines = [], currentLine = words[0];
                    for (let i = 1; i < words.length; i++) {
                        if (currentLine.length + words[i].length + 1 <= maxWidth) {
                            currentLine += ' ' + words[i];
                        } else {
                            lines.push(currentLine);
                            currentLine = words[i];
                        }
                    }
                    lines.push(currentLine);
                    return lines.join('\n');
                };

                const wrappedText = node.type === 'chapter' ? wrapText(text, 25) : text;

                const sprite = new SpriteText(wrappedText);
                sprite.fontFace = 'Arial';
                sprite.fontWeight = 'bold';

                if (node.type === 'chapter') {
                    sprite.textHeight = 7;
                    sprite.position.y = node.val + 9;
                    sprite.color = '#ffffff';
                } else if (node.type === 'consolidation_practice') {
                    sprite.textHeight = 5;
                    sprite.position.y = node.val + 6;
                    sprite.color = '#ffffaa'; // M√†u v√†ng nh·∫°t cho n·ªïi b·∫≠t
                } else { // lesson
                    sprite.textHeight = 4.5;
                    sprite.position.y = node.val + 5;
                    sprite.color = '#cccccc';
                }
                
                group.add(sprite);
            }
            
            return group;
        })
        .linkColor(link => getLinkColor(link))
        .linkWidth(link => {
          const baseWidth = calculateLinkWidth(link);
          if (highlightLinks.size === 0) return baseWidth;
          return highlightLinks.has(link) ? baseWidth * 1.5 : baseWidth * 0.3;
        })
        .linkDirectionalArrowLength(link => {
          if (link.type === 'sub_knowledge') return 3;
          if (highlightLinks.size === 0) return 6;
          return highlightLinks.has(link) ? 8 : 4;
        })
        .linkDirectionalArrowRelPos(1)
        .linkDirectionalArrowColor(link => getLinkColor(link))
        .linkOpacity(link => {
          if (highlightLinks.size === 0) return 0.6;
          return highlightLinks.has(link) ? 0.9 : 0.1;
        })
        .linkCurvature(0.2)
        .linkDirectionalParticles(link => {
          return (highlightLinks.has(link) && link.type !== 'sub_knowledge') ? 4 : 0;
        })
        .linkDirectionalParticleWidth(3)
        .linkDirectionalParticleSpeed(0.006)
        .onNodeHover(node => {
          if (!isNodeSelected) {
            hoveredNode = node;
            if (node && (node.type === 'chapter' || node.type === 'consolidation_practice')) {
              highlightNodeConnections(node, false);
            } else {
              clearHighlight();
            }
          }
        })
        .onNodeClick(node => {
          if (node.type === 'chapter') {
            isNodeSelected = true;
            selectedNode = node;
            showNodeDetail(node);
            highlightNodeConnections(node, true);
          }
        })
        .onBackgroundClick(() => {
          closeDetail();
          clearHighlight();
          isNodeSelected = false;
          hoveredNode = null;
        });

    Graph.d3Force('charge').strength(-400);
    Graph.d3Force('link').distance(link => link.type === 'sub_knowledge' ? 30 : 120);
    Graph.d3Force('center').strength(0.2);

    const layerForce = (alpha) => {
      fullKnowledgeData.nodes.forEach(node => {
        let targetY = 0;
        if (node.group === 12) targetY = 150;
        else if (node.group === 11) targetY = 0;
        else if (node.group === 10) targetY = -150;
        
        node.vy -= (node.y - targetY) * 0.8 * alpha;
        
        const maxDistance = 300;
        const dx = node.x;
        const dz = node.z;
        const distance = Math.sqrt(dx * dx + dz * dz);
        
        if (distance > maxDistance) {
          const scale = maxDistance / distance;
          node.vx -= (node.x - dx * scale) * 0.15;
          node.vz -= (node.z - dz * scale) * 0.15;
        }
        
        if (alpha < 0.01) {
          node.y = targetY;
          node.vy = 0;
        }
      });
    };
    Graph.d3Force('layering', layerForce);

    setTimeout(() => {
      const scene = Graph.scene();
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);
      const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight1.position.set(200, 200, 200);
      scene.add(directionalLight1);
      const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
      directionalLight2.position.set(-200, -200, -200);
      scene.add(directionalLight2);

      function createCirclePlane(y, label, color) {
        const radius = 400;
        const segments = 64;
        
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        canvas.width = 512; canvas.height = 512;
        const gradient = context.createRadialGradient(256, 256, 0, 256, 256, 256);
        gradient.addColorStop(0, 'rgba(40, 50, 90, 0.3)');
        gradient.addColorStop(1, 'rgba(20, 25, 45, 0.1)');
        context.fillStyle = gradient;
        context.fillRect(0, 0, 512, 512);
        const planeTexture = new THREE.CanvasTexture(canvas);
        const planeMaterial = new THREE.MeshBasicMaterial({ map: planeTexture, transparent: true, side: THREE.DoubleSide });
        const planeGeometry = new THREE.CircleGeometry(radius, segments);
        const circlePlane = new THREE.Mesh(planeGeometry, planeMaterial);
        circlePlane.position.set(0, y, 0);
        circlePlane.rotation.x = Math.PI / 2;
        scene.add(circlePlane);

        const ringGeometry = new THREE.TorusGeometry(radius, 2, 16, 100);
        const ringMaterial = new THREE.MeshBasicMaterial({ color: color, blending: THREE.AdditiveBlending, transparent: true, opacity: 0.7 });
        const ring = new THREE.Mesh(ringGeometry, ringMaterial);
        ring.position.set(0, y, 0);
        ring.rotation.x = Math.PI / 2;
        scene.add(ring);
        
        const labelSprite = new SpriteText(label);
        labelSprite.color = '#FFFFFF';
        labelSprite.textHeight = 16;
        labelSprite.fontWeight = 'bold';
        labelSprite.position.set(radius - 50, y + 20, 0);
        scene.add(labelSprite);
      }
      createCirclePlane(150, 'To√°n 12 - T·ªïng h·ª£p & ·ª®ng d·ª•ng', 0xff8844);
      createCirclePlane(0, 'To√°n 11 - X√¢y d·ª±ng C√¥ng c·ª•', 0xffdd44);
      createCirclePlane(-150, 'To√°n 10 - N·ªÅn t·∫£ng', 0x8888ff);
    }, 100);

    setTimeout(() => {
        Graph.cameraPosition({ x: 0, y: 350, z: 800 }, { x: 0, y: 0, z: 0 }, 1500);
    }, 500);

    function highlightNodeConnections(node, isPermanent) {
        highlightNodes.clear();
        highlightLinks.clear();

        if (node) {
            highlightNodes.add(node.id);
            if (node.parentChapter) highlightNodes.add(node.parentChapter); // Highlight c·∫£ ch∆∞∆°ng cha n·∫øu node con ƒë∆∞·ª£c ch·ªçn

            fullKnowledgeData.links.forEach(link => {
                const sourceId = typeof link.source === 'object' ? link.source.id : link.source;
                const targetId = typeof link.target === 'object' ? link.target.id : link.target;
                
                // M·ªü r·ªông logic highlight
                const isRelatedToNode = sourceId === node.id || targetId === node.id;
                const isRelatedToParent = node.parentChapter && (sourceId === node.parentChapter || targetId === node.parentChapter);
                
                if (isRelatedToNode || isRelatedToParent) {
                    highlightLinks.add(link);
                    highlightNodes.add(sourceId);
                    highlightNodes.add(targetId);
                }
            });
        }

        Graph.graphData().nodes.forEach(n => {
            if (!n.__threeObj) return;
            const isHighlighted = highlightNodes.has(n.id);
            const shouldBeVisible = isHighlighted || highlightNodes.size === 0;

            const sphere = n.__threeObj.children[0];
            if (sphere && sphere.material) {
                sphere.material.opacity = shouldBeVisible ? 0.95 : 0.15;
                sphere.material.emissiveIntensity = isHighlighted ? 0.4 : 0.1;
            }
            
            const sprite = n.__threeObj.children[1];
            if (sprite && sprite.material) {
                sprite.material.opacity = shouldBeVisible ? 1 : 0.2;
            }
        });

        Graph.linkColor(Graph.linkColor()).linkWidth(Graph.linkWidth()).linkOpacity(Graph.linkOpacity()).linkDirectionalParticles(Graph.linkDirectionalParticles());
    }

    function clearHighlight() {
        highlightNodes.clear();
        highlightLinks.clear();
        Graph.graphData().nodes.forEach(n => {
            if (n.__threeObj) {
                const sphere = n.__threeObj.children[0];
                if(sphere && sphere.material) {
                    sphere.material.opacity = 0.95;
                    sphere.material.emissiveIntensity = 0.4;
                }
                const sprite = n.__threeObj.children[1];
                if(sprite && sprite.material) sprite.material.opacity = 1;
            }
        });
        Graph.linkColor(Graph.linkColor()).linkWidth(Graph.linkWidth()).linkOpacity(Graph.linkOpacity()).linkDirectionalParticles(Graph.linkDirectionalParticles());
    }
    
    // ‚ú® THAY ƒê·ªîI 3: N√¢ng c·∫•p h√†m showNodeDetail ƒë·ªÉ hi·ªÉn th·ªã c·∫£ c√°c lo·∫°i node m·ªõi
    function showNodeDetail(node) {
      if (node.type !== 'chapter') return;
      
      const detail = document.getElementById('node-detail');
      const content = document.getElementById('detail-content');
      const badge = `<span class="badge badge-${node.group}">L·ªõp ${node.group}</span>`;
      
      let prerequisitesHTML = '';
      if (node.prerequisites && node.prerequisites.length > 0) {
        prerequisitesHTML = '<h3>üî¥ Ki·∫øn th·ª©c ti√™n quy·∫øt:</h3><ul>' + node.prerequisites.map(p => `<li>${p}</li>`).join('') + '</ul>';
      }
      
      let applicationsHTML = '';
      if (node.applications && node.applications.length > 0) {
        applicationsHTML = '<h3>üü¢ Ki·∫øn th·ª©c ·ª©ng d·ª•ng:</h3><ul>' + node.applications.map(a => `<li>${a}</li>`).join('') + '</ul>';
      }
      
      let lessonsHTML = '<h3>üìñ C√°c b√†i h·ªçc v√† m·ª•c ti√™u:</h3>';
      if (node.lessons && node.lessons.length > 0) {
        node.lessons.forEach(lesson => {
          let lessonTitleStyle = 'color: #f5d442; font-size: 12px; margin: 10px 0 5px 0;';
          if (lesson.type === 'consolidation_practice') {
              lessonTitleStyle += 'background-color: rgba(255, 215, 0, 0.15); padding: 3px 5px; border-radius: 4px; display: inline-block;';
          }
          lessonsHTML += `<h4 style="${lessonTitleStyle}">${lesson.name}</h4>`;

          if (lesson.learning_objectives) {
            lessonsHTML += '<ul style="padding-left: 10px;">';
            lesson.learning_objectives.forEach(lo => {
              let levelColor = '#aaa';
              if (lo.level === 'Nh·∫≠n bi·∫øt') levelColor = '#6CA0DC';
              if (lo.level === 'Th√¥ng hi·ªÉu') levelColor = '#77dd77';
              if (lo.level === 'V·∫≠n d·ª•ng') levelColor = '#ffd700';
              if (lo.level === 'V·∫≠n d·ª•ng cao') levelColor = '#ff6961';
              
              lessonsHTML += `<li style="font-size: 11px; margin-bottom: 5px;"><strong style="color: ${levelColor};">[${lo.level}]</strong> ${lo.content}</li>`;
            });
            lessonsHTML += '</ul>';
          }
        });
      }
      
      content.innerHTML = `
        <h2>${badge} ${node.id}</h2>
        <p style="color: #aaa; font-size: 11px; margin-bottom: 10px;">${node.description || ''}</p>
        ${prerequisitesHTML}
        ${applicationsHTML}
        ${lessonsHTML}
      `;
      
      detail.classList.add('active');
    }

    function closeDetail() {
      document.getElementById('node-detail').classList.remove('active');
      selectedNode = null;
    }

    function searchNode(query) {
      if (!query) {
        clearHighlight();
        isNodeSelected = false;
        hoveredNode = null;
        closeDetail();
        return;
      }
      
      const found = fullKnowledgeData.nodes.find(node => 
        node.type === 'chapter' && node.id.toLowerCase().includes(query.toLowerCase())
      );
      
      if (found) {
        selectedNode = found; // C·∫≠p nh·∫≠t selectedNode
        isNodeSelected = true;
        highlightNodeConnections(found, true);
        showNodeDetail(found);
        Graph.cameraPosition(
          { x: found.x + 100, y: found.y + 50, z: found.z + 100 },
          { x: found.x, y: found.y, z: found.z },
          1000
        );
      }
    }

    function viewAngle() { Graph.cameraPosition({ x: 0, y: 350, z: 800 }, { x: 0, y: 0, z: 0 }, 1000); }
    function viewTop() { Graph.cameraPosition({ x: 0, y: 600, z: 0 }, { x: 0, y: 0, z: 0 }, 1000); }
    function viewSide() { Graph.cameraPosition({ x: 600, y: 0, z: 0 }, { x: 0, y: 0, z: 0 }, 1000); }

    function resetView() {
      clearHighlight();
      closeDetail();
      isNodeSelected = false;
      hoveredNode = null;
      selectedNode = null;
      document.getElementById('search-input').value = '';
      viewAngle();
    }

    let physicsEnabled = true;
    function togglePhysics() {
      physicsEnabled = !physicsEnabled;
      if (physicsEnabled) {
        Graph.d3ReheatSimulation();
      } else {
        Graph.d3AlphaDecay(1);
      }
    }
  </script>
</body>
</html>