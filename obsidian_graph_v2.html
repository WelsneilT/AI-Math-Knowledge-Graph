<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toán Học - Obsidian Graph (Full Sync)</title>
    <script src="https://unpkg.com/force-graph"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #1E1E1E; color: #E5E7EB; overflow: hidden; }
        #graph { width: 100vw; height: 100vh; }
        .ui-panel { position: fixed; background: rgba(40,44,52,0.95); padding: 18px 22px; border-radius: 12px; border: 1px solid rgba(106,142,174,0.3); backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,0.5); transition: 0.3s; z-index: 100; }
        .ui-panel:hover { border-color: rgba(106,142,174,0.6); }
        h3, h4 { color: #D1A15A; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; }
        h3 { font-size: 14px; margin-bottom: 14px; } h4 { font-size: 13px; margin-bottom: 10px; }
        #info { top: 20px; left: 20px; max-width: 280px; }
        #info p { margin: 8px 0; font-size: 13px; color: #B8BEC8; display: flex; justify-content: space-between; }
        #info p strong { color: #6A8EAE; } #info p span { background: rgba(106,142,174,0.2); padding: 3px 10px; border-radius: 8px; color: #D1A15A; font-weight: 600; }
        #search { top: 20px; right: 20px; }
        #search input { background: rgba(30,30,30,0.8); border: 1px solid rgba(106,142,174,0.2); color: #E5E7EB; padding: 10px 16px; border-radius: 8px; width: 280px; font-size: 13px; }
        #search input:focus { outline: none; border-color: #6A8EAE; box-shadow: 0 0 0 3px rgba(106,142,174,0.15); }
        #controls { bottom: 20px; right: 20px; display: flex; gap: 8px; padding: 12px 16px; }
        button { background: linear-gradient(135deg, #6A8EAE, #5A7A9A); color: white; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 500; box-shadow: 0 2px 8px rgba(106,142,174,0.3); }
        button:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(106,142,174,0.5); }
        button.active { background: linear-gradient(135deg, #D1A15A, #B8904A); }
        #legend { bottom: 20px; left: 20px; }
        .legend-item { display: flex; align-items: center; margin: 6px 0; font-size: 12px; }
        .legend-color { width: 16px; height: 16px; border-radius: 50%; margin-right: 10px; border: 1px solid rgba(255,255,255,0.2); }
        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(30,30,30,0.95); display: flex; align-items: center; justify-content: center; z-index: 9999; opacity: 1; transition: 0.5s; }
        .loading-overlay.hide { opacity: 0; pointer-events: none; }
        .spinner { width: 50px; height: 50px; border: 4px solid rgba(106,142,174,0.2); border-top-color: #6A8EAE; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #tooltip {
            position: absolute; background: rgba(30,30,30,0.95); color: #E5E7EB; padding: 14px 18px;
            border-radius: 10px; border: 1px solid rgba(106,142,174,0.3); font-size: 13px; pointer-events: none;
            max-width: 320px; box-shadow: 0 6px 24px rgba(0,0,0,0.6); opacity: 0; transition: opacity 0.2s;
            backdrop-filter: blur(12px); z-index: 1000; line-height: 1.5;
        }
        .missing { color: #E05A8E !important; font-style: italic; }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loading"><div class="spinner"></div></div>
    <div id="graph"></div>
    <div id="tooltip"></div>

    <div id="info" class="ui-panel">
        <h3>THỐNG KÊ</h3>
        <p><strong>Nodes:</strong> <span id="node-count">0</span></p>
        <p><strong>Links:</strong> <span id="link-count">0</span></p>
    </div>

    <div id="search" class="ui-panel">
        <input type="text" id="search-input" placeholder="Tìm kiếm...">
    </div>

    <div id="controls" class="ui-panel">
        <button onclick="Graph.zoomToFit(1000, 80)">Reset View</button>
        <button id="physics-btn" onclick="togglePhysics()" class="active">Physics</button>
        <button id="labels-btn" onclick="toggleLabels()" class="active">Labels</button>
    </div>

    <div id="legend" class="ui-panel">
        <h4>CHÚ THÍCH</h4>
        <div class="legend-item"><div class="legend-color" style="background: #D1A15A;"></div><span>Hub (>10 kết nối)</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #6A8EAE;"></div><span>Quan trọng (6-10 kết nối)</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #5A9D9A;"></div><span>Liên quan (3-5 kết nối)</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #7A8A9A;"></div><span>Cơ bản (<=2 kết nối)</span></div>
    </div>

    <script>
        // === DỮ LIỆU TỪ OBSIDIAN (ĐÃ SỬA LỖI ĐỊNH DẠNG) ===
        const rawFiles = [
    {
        "name": "Bất đẳng thức. Bất phương trình.md",
        "content": "- [[Bất đẳng thức]]\n- [[Bất phương trình]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Phương trình, Hệ phương trình]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Giới hạn]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Phương pháp tọa độ trong không gian]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]"
    },
    {
        "name": "Cung, góc và công thức lượng giác.md",
        "content": "- [[Cung và góc lượng giác]]\n- [[Giá trị lượng giác của một cung]]\n- [[Công thức lượng giác]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Giá trị lượng giác của một cung]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Đạo hàm]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Số phức]]\n- [[Tích vô hướng của hai vectơ]]"
    },
    {
        "name": "Dãy số, Cấp số cộng và Cấp số nhân.md",
        "content": "```\n---\ntags:\n  - MOC\n  - Đại_số_11\n---\n\n# Chương 3: Dãy số - Cấp số cộng - Cấp số nhân\n\n## Các đơn vị kiến thức\n\n- [[Phương pháp quy nạp toán học]]\n- [[Dãy số]]\n- [[Cấp số cộng]]\n- [[Cấp số nhân]]\n\n---\n\nQuay về: [[Toán 11]]\n\n---\n\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Phương trình, Hệ phương trình]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Giới hạn]]\n```"
    },
    {
        "name": "Giá trị lượng giác của một cung.md",
        "content": "---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Phương pháp tọa độ trong mặt phẳng]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Cung, góc và công thức lượng giác]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Tích vô hướng của hai vec tơ]]\n- [[Đạo hàm]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Số phức]]"
    },
    {
        "name": "Giới hạn.md",
        "content": "```markdown\n---\ntags:\n  - MOC\n  - Giải_tích_11\n---\n\n# Chương 4: Giới hạn\n\n## Các đơn vị kiến thức\n\n- [[Giới hạn của dãy số]]\n- [[Giới hạn của hàm số]]\n- [[Hàm số liên tục]]\n\n---\n\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Dãy số, Cấp số cộng và Cấp số nhân]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Phương trình, Hệ phương trình]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Đạo hàm]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n```"
    },
    {
        "name": "Hàm số bậc nhất và bậc hai.md",
        "content": "```markdown\n## Các đơn vị kiến thức\n- [[Đại cương về hàm số]]\n- [[Hàm số bậc nhất y = ax + b]]\n- [[Hàm số bậc hai y = ax^2 + bx + c]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Phương trình, Hệ phương trình]]\n- [[Bất đẳng thức. Bất phương trình]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Đạo hàm]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n```"
    },
    {
        "name": "Hàm số lũy thừa, hàm số mũ và hàm số logarit.md",
        "content": "```markdown\n---\ntags:\n  - MOC\n  - Giải_tích_12\n---\n# Chương 2: Hàm số lũy thừa, hàm số mũ và hàm số logarit\n\n## Các đơn vị kiến thức\n- [[Lũy thừa và Hàm số lũy thừa]]\n- [[Logarit và Hàm số mũ, Hàm số logarit]]\n- [[Phương trình mũ và phương trình logarit]]\n- [[Bất phương trình mũ và bất phương trình logarit]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Đạo hàm]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n```"
    },
    {
        "name": "Hàm số lượng giác và phương trình lượng giác.md",
        "content": "---\ntags:\n  - MOC\n  - Giải_tích_11\n---\n\n# Chương 1: Hàm số lượng giác và Phương trình lượng giác\n\n## Các đơn vị kiến thức\n- [[Hàm số lượng giác]]\n- [[Phương trình lượng giác cơ bản]]\n- [[Một số phương trình lượng giác thường gặp]]\n\n---\n\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Giá trị lượng giác của một cung]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Phương trình, Hệ phương trình]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Giới hạn]]\n- [[Đạo hàm]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Số phức]]"
    },
    {
        "name": "Khối đa diện.md",
        "content": "---\ntags:\n  - MOC\n  - Hình_học_12\n---\n# Chương 5: Khối đa diện\n\n## Các đơn vị kiến thức\n- [[Khái niệm về khối đa diện, khối đa diện lồi và khối đa diện đều]]\n- [[Thể tích của khối đa diện]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Tích vô hướng của hai vectơ]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Mặt nón, Mặt trụ, Mặt cầu]]\n- [[Phương pháp tọa độ trong không gian]]"
    },
    {
        "name": "Mặt nón, Mặt trụ, Mặt cầu.md",
        "content": "---\ntags:\n  - MOC\n  - Hình_học_12\n---\n# Chương 6: Mặt nón, Mặt trụ, Mặt cầu\n\n## Các đơn vị kiến thức\n- [[Khái niệm về mặt nón, mặt trụ, mặt cầu]]\n- [[Diện tích và thể tích của mặt nón, mặt trụ, mặt cầu]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Tích vô hướng của hai vectơ]]\n- [[Phương pháp tọa độ trong không gian]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Nguyên hàm, Tích phân và Ứng dụng]]"
    },
    {
        "name": "Mệnh đề. Tập hợp.md",
        "content": "```markdown\n## Các đơn vị kiến thức\n- [[Mệnh đề]]\n- [[Tập hợp]]\n---\n## Liên kết kiến thức\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Dãy số, Cấp số cộng và Cấp số nhân]]\n- [[Giá trị lượng giác của một cung]]\n- [[Giới hạn]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Phương pháp tọa độ trong không gian]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Phương trình, Hệ phương trình]]\n- [[Số phức]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Tổ hợp và Xác suất]]\n- [[Đạo hàm]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n```"
    },
    {
        "name": "Nguyên hàm, Tích phân và Ứng dụng.md",
        "content": "---\ntags:\n  - MOC\n  - Giải_tích_12\n---\n# Chương 3: Nguyên hàm - Tích phân và Ứng dụng\n\n## Các đơn vị kiến thức\n- [[Nguyên hàm]]\n- [[Tích phân]]\n- [[Ứng dụng của tích phân trong hình học]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Giới hạn]]\n- [[Đạo hàm]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Phương trình, Hệ phương trình]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Mặt nón, Mặt trụ, Mặt cầu]]"
    },
    {
        "name": "Phép dời hình và phép đồng dạng trong mặt phẳng.md",
        "content": "---\ntags:\n  - MOC\n  - Hình_học_11\n---\n\n# Chương 6: Phép dời hình và phép đồng dạng trong mặt phẳng\n\n## Các đơn vị kiến thức\n\n- [[Phép biến hình và phép tịnh tiến]]\n- [[Phép đối xứng trục]]\n- [[Phép đối xứng tâm]]\n- [[Phép quay]]\n- [[Khái niệm về phép dời hình và hai hình bằng nhau]]\n- [[Phép vị tự và phép đồng dạng]]\n\n---\n\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Tích vô hướng của hai vectơ]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Số phức]]"
    },
    {
        "name": "Phương pháp tọa độ trong không gian.md",
        "content": "---\ntags:\n  - MOC\n  - Hình_học_12\n---\n# Chương 7: Phương pháp tọa độ trong không gian\n\n## Các đơn vị kiến thức\n- [[Hệ tọa độ trong không gian]]\n- [[Phương trình mặt phẳng]]\n- [[Phương trình đường thẳng]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Tích vô hướng của hai vectơ]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Mặt nón, Mặt trụ, Mặt cầu]]"
    },
    {
        "name": "Phương pháp tọa độ trong mặt phẳng.md",
        "content": "- [[Phương trình đường thẳng]]\n- [[Phương trình đường tròn]]\n- [[Phương trình đường elip]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Tích vô hướng của hai vectơ]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Phương pháp tọa độ trong không gian]]\n- [[Số phức]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Phép dời hình và phép đồng dạng trong mặt phẳng]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Mặt nón, Mặt trụ, Mặt cầu]]"
    },
    {
        "name": "Phương trình, Hệ phương trình.md",
        "content": "---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Hàm số bậc nhất và bậc hai]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Dãy số, Cấp số cộng và Cấp số nhân]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Phương pháp tọa độ trong không gian]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Số phức]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]"
    },
    {
        "name": "Số phức.md",
        "content": "---\ntags:\n  - MOC\n  - Giải_tích_12\n---\n# Chương 4: Số phức\n\n## Các đơn vị kiến thức\n- [[Khái niệm số phức]]\n- [[Phép cộng, trừ và nhân số phức]]\n- [[Phép chia số phức]]\n- [[Phương trình bậc hai với hệ số thực]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Phương trình, Hệ phương trình]]\n- [[Vectơ]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Giá trị lượng giác của một cung]]\n- [[Cung, góc và công thức lượng giác]]"
    },
    {
        "name": "Sự đồng biến, nghịch biến của hàm số.md",
        "content": "```markdown\n---\n\ntags:\n  - Khảo_sát_hàm_số\n  - Giải_tích_12\n\n---\n\n# Sự đồng biến, nghịch biến của hàm số\n\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Phương trình, Hệ phương trình]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Giới hạn]]\n- [[Đạo hàm]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n```"
    },
    {
        "name": "Thống kê.md",
        "content": "```markdown\n- [[Khái niệm cơ bản về thống kê]]\n- [[Phương sai và độ lệch chuẩn]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Tổ hợp và Xác suất]]\n```"
    },
    {
        "name": "Toán 10.md",
        "content": "- [[Hàm số bậc nhất và bậc hai]]\n- [[Mệnh đề. Tập hợp]]\n- [[Phương trình, Hệ phương trình]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Thống kê]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Vectơ]]\n- [[Tích vô hướng của hai vectơ]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n---\n## Liên kết kiến thức\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Toán 11]]\n- [[Toán 12]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Dãy số, Cấp số cộng và Cấp số nhân]]\n- [[Giá trị lượng giác của một cung]]\n- [[Giới hạn]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Phương pháp tọa độ trong không gian]]\n- [[Phương trình, Hệ phương trình]]\n- [[Số phức]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Tổ hợp và Xác suất]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Đạo hàm]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]"
    },
    {
        "name": "Toán 11.md",
        "content": "```markdown\n## Phần 1: Đại số và Giải tích 11\n\n- **Chương 1:** [[Hàm số lượng giác và phương trình lượng giác]]\n- **Chương 2:** [[Tổ hợp và Xác suất]]\n- **Chương 3:** [[Dãy số, Cấp số cộng và Cấp số nhân]]\n- **Chương 4:** [[Giới hạn]]\n- **Chương 5:** [[Đạo hàm]]\n\n## Phần 2: Hình học 11\n\n- **Chương 6:** [[Phép dời hình và phép đồng dạng trong mặt phẳng]]\n- **Chương 7:** [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- **Chương 8:** [[Vectơ và quan hệ vuông góc trong không gian]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Phương trình, Hệ phương trình]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Vectơ]]\n- [[Tích vô hướng của hai vec tơ]]\n- [[Giá trị lượng giác của một cung]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Toán 12]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Khối đa diện]]\n- [[Mặt nón, Mặt trụ, Mặt cầu]]\n- [[Phương pháp tọa độ trong không gian]]\n```"
    },
    {
        "name": "Toán 12.md",
        "content": "```markdown\ntags:\n\n- MOC\n  - Toán_học\n\n---\n\n# Sơ đồ nội dung Toán 12\n\nĐây là nơi tổng hợp toàn bộ kiến thức và các chương của môn Toán lớp 12, bao gồm Giải tích và Hình học.\n\n## Phần 1: Giải tích 12\n\n- **Chương 1:** [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]\n- **Chương 2:** [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- **Chương 3:** [[Nguyên hàm, Tích phân và Ứng dụng]]\n- **Chương 4:** [[Số phức]]\n\n## Phần 2: Hình học 12\n\n- **Chương 5:** [[Khối đa diện]]\n- **Chương 6:** [[Mặt nón, Mặt trụ, Mặt cầu]]\n- **Chương 7:** [[Phương pháp tọa độ trong không gian]]\n```"
    },
    {
        "name": "Toán phổ thông.md",
        "content": "[[Toán 10]]\n[[Toán 11]]\n[[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Toán 10]]\n- [[Toán 11]]\n- [[Toán 12]]"
    },
    {
        "name": "Tích vô hướng của hai vectơ.md",
        "content": "- [[Giá trị lượng giác của một góc bất kỳ từ 0° đến 180°]]\n- [[Tích vô hướng của hai vec tơ]]]\n- [[Các hệ thức lượng trong tam giác]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Cung, góc và công thức lượng giác]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Phương pháp tọa độ trong không gian]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]"
    },
    {
        "name": "Tổ hợp và Xác suất.md",
        "content": "---\ntags:\n  - MOC\n  - Đại_số_11\n---\n\n# Chương 2: Tổ hợp và Xác suất\n\n## Các đơn vị kiến thức\n- [[Quy tắc đếm]]\n- [[Hoán vị, Chỉnh hợp, Tổ hợp]]\n- [[Nhị thức Niu-tơn]]\n- [[Phép thử và biến cố]]\n- [[Xác suất của biến cố]]\n\n---\n\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Mệnh đề. Tập hợp]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Thống kê]]"
    },
    {
        "name": "Vectơ và quan hệ vuông góc trong không gian.md",
        "content": "```markdown\n---\ntags:\n---\n# Chương 8: Vectơ và quan hệ vuông góc trong không gian\n\n## Các đơn vị kiến thức\n- [[Vectơ trong không gian]]\n- [[Hai đường thẳng vuông góc]]\n- [[Đường thẳng vuông góc với mặt phẳng]]\n- [[Hai mặt phẳng vuông góc]]\n- [[Khoảng cách]]\n\n---\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Vectơ]]\n- [[Tích vô hướng của hai vectơ]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Phương pháp tọa độ trong không gian]]\n```"
    },
    {
        "name": "Vectơ.md",
        "content": "- [[Vectơ và các phép toán cộng, trừ, nhân với một số]]\n- [[Hệ trục tọa độ]]\n---\n## Liên kết kiến thức\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Tích vô hướng của hai vectơ]]\n- [[Phép dời hình và phép đồng dạng trong mặt phẳng]]\n- [[Phương pháp tọa độ trong mặt phẳng]]\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Đường thẳng, mặt phẳng và quan hệ song song trong không gian]]\n- [[Phương pháp tọa độ trong không gian]]\n- [[Khối đa diện]]\n- [[Mặt nón, Mặt trụ, Mặt cầu]]"
    },
    {
        "name": "Đường thẳng, mặt phẳng và quan hệ song song trong không gian.md",
        "content": "```markdown\n---\ntags:\n- MOC\n- Hình_học_11\n---\n\n# Chương 7: Đường thẳng, mặt phẳng và quan hệ song song trong không gian\n\n## Các đơn vị kiến thức\n\n- [[Đại cương về đường thẳng và mặt phẳng]]\n- [[Hai đường thẳng chéo nhau và hai đường thẳng song song]]\n- [[Đường thẳng và mặt phẳng song song]]\n- [[Hai mặt phẳng song song]]\n\n---\n\nQuay về: [[Toán 11]]\n\n---\n\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n\n- [[Vectơ]]\n- [[Tích vô hướng của hai vec tơ]]\n\n### Kiến thức kế thừa (Ứng dụng)\n\n- [[Vectơ và quan hệ vuông góc trong không gian]]\n- [[Khối đa diện]]\n- [[Mặt nón, Mặt trụ, Mặt cầu]]\n- [[Phương pháp tọa độ trong không gian]]\n```"
    },
    {
        "name": "Đạo hàm.md",
        "content": "---\ntags:\n  - MOC\n  - Giải_tích_11\n---\n\n# Chương 5: Đạo hàm\n\n## Các đơn vị kiến thức\n\n- [[Định nghĩa và ý nghĩa của đạo hàm]]\n- [[Quy tắc tính đạo hàm]]\n- [[Đạo hàm của hàm số lượng giác]]\n- [[Đạo hàm cấp hai]]\n\n---\n\nQuay về: [[Toán 11]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Giới hạn]]\n- [[Hàm số bậc nhất và bậc hai]]\n- [[Hàm số lũy thừa, hàm số mũ và hàm số logarit]]\n- [[Hàm số lượng giác và phương trình lượng giác]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số]]"
    },
    {
        "name": "Ứng dụng đạo hàm để khảo sát và vẽ đồ thị hàm số.md",
        "content": "---\ntags:\n  - MOC\n  - Giải_tích_12\n---\n# Chương 1: Ứng dụng đạo hàm để khảo sát và vẽ đồ thị của hàm số\n\n## Các đơn vị kiến thức\n- [[Sự đồng biến, nghịch biến của hàm số]]\n- [[Cực trị của hàm số]]\n- [[Giá trị lớn nhất và giá trị nhỏ nhất của hàm số]]\n- [[Bảng biến thiên và đồ thị của hàm số]]\n- [[Đường tiệm cận]]\n\n---\nQuay về: [[Toán 12]]\n---\n## Liên kết kiến thức\n\n### Kiến thức tiên quyết (Nền tảng)\n- [[Giới hạn]]\n- [[Đạo hàm]]\n- [[Sự đồng biến, nghịch biến của hàm số]]\n\n### Kiến thức kế thừa (Ứng dụng)\n- [[Nguyên hàm, Tích phân và Ứng dụng]]\n- [[Bất đẳng thức. Bất phương trình]]\n- [[Phương trình, Hệ phương trình]]"
    }
];

        // === PHÂN TÍCH DỮ LIỆU (HOÀN NGUYÊN KHÔNG LỌC NODE) ===
        const fileNames = rawFiles.map(f => f.name.replace('.md', ''));
        const allNodesMap = new Map();
        const allLinksSet = new Set();
        const fileContentMap = new Map();

        rawFiles.forEach(file => {
            const name = file.name.replace('.md', '');
            fileContentMap.set(name, file.content);

            allNodesMap.set(name, {
                id: name,
                label: name,
                isFile: true, // File có sẵn
            });

            // Lấy tất cả các liên kết ra
            const matches = file.content.match(/\[\[([^\]\]]+)\]\]/g) || [];
            matches.forEach(m => {
                const link = m.slice(2, -2).trim();
                
                // Nếu node chưa có trong danh sách thì tạo node (kể cả nó chưa có file)
                if (!allNodesMap.has(link)) {
                    allNodesMap.set(link, {
                        id: link,
                        label: link,
                        isFile: fileNames.includes(link), // Kiểm tra xem file đã tồn tại chưa
                        content: `<strong style="color: #E05A8E;">Chưa có file:</strong> <code>${link}.md</code>`,
                    });
                }
                
                const key = `${name}→${link}`;
                if (!allLinksSet.has(key)) allLinksSet.add(key);
            });
        });
        
        // Hoàn nguyên: Giữ lại TẤT CẢ node và link
        const graphData = {
            nodes: Array.from(allNodesMap.values()),
            links: Array.from(allLinksSet).map(k => {
                const [s, t] = k.split('→');
                return { source: s, target: t };
            })
        };

        // Gán content cho các node đã có file
        graphData.nodes.forEach(node => {
            if (node.isFile) {
                node.content = fileContentMap.get(node.id);
            }
        });


        // === GRAPH ===
        const Graph = ForceGraph();
        let showLabels = true;
        let physicsEnabled = true;
        const tooltip = document.getElementById('tooltip');

        let highlightNodes = new Set();
        let highlightLinks = new Set();
        let hoverNode = null;

        function initializeGraph() {
            const nodeDegrees = {};
            graphData.nodes.forEach(n => nodeDegrees[n.id] = 0);
            graphData.links.forEach(l => { 
                // Tính toán độ (số lượng kết nối)
                nodeDegrees[l.source]++; 
                nodeDegrees[l.target]++; 
            });

            document.getElementById('node-count').textContent = graphData.nodes.length;
            document.getElementById('link-count').textContent = graphData.links.length;

            const getNodeColor = n => {
                const deg = nodeDegrees[n.id] || 0;
                // Màu sắc dựa trên độ (số lượng kết nối)
                if (deg > 10) return '#D1A15A'; // Hub (Vàng)
                if (deg > 5) return '#6A8EAE';  // Quan trọng (Xanh đậm)
                if (deg > 2) return '#5A9D9A';  // Liên quan (Xanh ngọc)
                return '#7A8A9A';               // Cơ bản (Xám)
            };
            
            // Kích thước node phụ thuộc vào số lượng kết nối và trạng thái file
            const getNodeSize = n => n.isFile 
                ? Math.max(7, Math.sqrt(nodeDegrees[n.id] || 0) * 4.5) 
                : Math.max(3.5, Math.sqrt(nodeDegrees[n.id] || 0) * 2.5);

            Graph(document.getElementById('graph'))
                .graphData(graphData)
                .nodeId('id')
                .nodeVal(getNodeSize)
                .nodeColor(getNodeColor)
                .nodeLabel('label')
                .nodeCanvasObject((node, ctx, scale) => {
                    const size = getNodeSize(node);
                    ctx.beginPath();
                    ctx.arc(node.x, node.y, size, 0, 2 * Math.PI);
                    
                    // --- LOGIC HIGHLIGHT NODE ---
                    const isHighlighted = highlightNodes.has(node.id) && hoverNode;
                    const isHovered = node === hoverNode;
                    
                    // Màu sắc và kích thước khi được highlight
                    let fillColor = getNodeColor(node);
                    
                    // Viền: Node có file thật: viền vàng. Node chưa có file: viền đỏ (nét đứt)
                    let strokeColor = node.isFile ? 'rgba(255, 215, 0, 0.7)' : 'rgba(224, 90, 142, 0.7)';
                    let lineWidth = 1.5;
                    
                    if (isHighlighted) {
                        fillColor = isHovered ? '#FFD700' : 'rgba(255, 255, 255, 0.8)'; // Làm sáng nút liền kề
                        lineWidth = 4;
                    } else if (hoverNode) {
                        // Mờ các nút không liên quan
                        fillColor = 'rgba(110, 110, 110, 0.2)'; 
                        strokeColor = 'rgba(110, 110, 110, 0.1)';
                    }
                    // ----------------------------

                    ctx.fillStyle = fillColor;
                    ctx.strokeStyle = strokeColor;
                    ctx.lineWidth = lineWidth;
                    ctx.setLineDash(node.isFile ? [] : [4, 4]); // Node chưa có file: viền nét đứt
                    ctx.fill(); ctx.stroke();
                    ctx.setLineDash([]);

                    if (showLabels && scale > 0.6) {
                        const fontSize = Math.max(10, 13 / scale);
                        ctx.font = `600 ${fontSize}px Inter`;
                        
                        let labelColor = isHighlighted ? '#FFF' : (hoverNode ? 'rgba(200, 200, 200, 0.5)' : '#E5E7EB');
                        if (!node.isFile && !hoverNode) { 
                            labelColor = 'rgba(224, 90, 142, 0.7)'; // Màu đỏ mờ cho node chưa tạo
                        }

                        ctx.fillStyle = labelColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(node.label, node.x, node.y + size + fontSize * 0.8);
                    }
                })
                .linkCanvasObject((link, ctx, scale) => {
                    // --- LOGIC HIGHLIGHT LINK ---
                    const isHighlighted = highlightLinks.has(link);
                    const color = isHighlighted ? 'rgba(102, 255, 204, 0.9)' : 'rgba(180,200,220,0.2)'; // Màu xanh nổi bật
                    const width = isHighlighted ? 3 : 1.3;

                    ctx.strokeStyle = color;
                    ctx.lineWidth = width;
                    ctx.beginPath();
                    ctx.moveTo(link.source.x, link.source.y);
                    ctx.lineTo(link.target.x, link.target.y);
                    ctx.stroke();
                    // ----------------------------
                })
                .linkWidth(link => highlightLinks.has(link) ? 3 : 1.3)
                .linkColor(link => highlightLinks.has(link) ? 'rgba(102, 255, 204, 0.9)' : 'rgba(180,200,220,0.2)')
                .linkDirectionalParticles(link => highlightLinks.has(link) ? 3 : 1)
                .linkDirectionalParticleWidth(link => highlightLinks.has(link) ? 2.5 : 1.6)
                .linkDirectionalParticleSpeed(0.004)
                .backgroundColor('#1E1E1E')
                .d3Force('charge', d3.forceManyBody().strength(-700)) // Lực đẩy: Giúp các cụm tách ra
                .d3Force('link', d3.forceLink().distance(150).strength(0.5)) // Lực hút: Kéo các node liên kết lại
                .d3Force('center', d3.forceCenter())
                .onEngineStop(() => {
                    document.getElementById('loading').classList.add('hide');
                    Graph.zoomToFit(1000, 100);
                })
                .onNodeHover(node => {
                // Xóa trạng thái highlight cũ
                highlightNodes.clear();
                highlightLinks.clear();
                hoverNode = node || null;

                if (node) {
                    // Cập nhật tooltip
                    const nodeLabelColor = node.isFile ? '#D1A15A' : '#E05A8E';
                    tooltip.innerHTML = `<strong style="color:${nodeLabelColor}">${node.label}</strong>
                        <hr style="border:0;border-top:1px solid #444;margin:8px 0;">
                        <div style="max-height:300px;overflow-y:auto;font-size:12.5px;line-height:1.6;">
                            ${node.content.replace(/\n/g, '<br>')}
                        </div>`;
                    tooltip.style.opacity = 1;

                    // Cập nhật trạng thái highlight mới
                    highlightNodes.add(node.id);
                    
                    graphData.links.forEach(link => {
                        if (link.source.id === node.id || link.target.id === node.id) {
                            highlightLinks.add(link);
                            highlightNodes.add(link.source.id);
                            highlightNodes.add(link.target.id);
                        }
                    });
                } else {
                    tooltip.style.opacity = 0;
                }

                // Yêu cầu biểu đồ vẽ lại để áp dụng hiệu ứng highlight
                Graph.nodeCanvasObject(Graph.nodeCanvasObject()).linkCanvasObject(Graph.linkCanvasObject());
            });

            document.getElementById('graph').addEventListener('mousemove', e => {
                if (tooltip.style.opacity > 0) {
                    tooltip.style.left = (e.clientX + 15) + 'px';
                    tooltip.style.top = (e.clientY + 15) + 'px';
                }
            });

            document.getElementById('search-input').addEventListener('input', e => {
                const term = e.target.value.toLowerCase().trim();
                if (!term) return;
                const matched = graphData.nodes.find(n => n.label.toLowerCase().includes(term));
                if (matched) {
                    Graph.centerAt(matched.x, matched.y, 800);
                    Graph.zoom(4, 800);
                }
            });
        }

        function togglePhysics() { physicsEnabled = !physicsEnabled; document.getElementById('physics-btn').classList.toggle('active'); physicsEnabled ? Graph.resumeAnimation() : Graph.pauseAnimation(); }
        function toggleLabels() { showLabels = !showLabels; document.getElementById('labels-btn').classList.toggle('active'); Graph.refresh(); }

        window.onload = initializeGraph;
    </script>
</body>
</html>